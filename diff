/*------------------------------------------------------------------------------
-- 개체 이름: IPARKTEST.PKG_FAAEI01
-- 만든 날짜: 2017-11-28 오전 10:10:57
-- 마지막으로 수정한 날짜: 2018-08-17 오후 5:23:05
-- 상태: VALID
------------------------------------------------------------------------------*/
CREATE OR REPLACE PACKAGE BODY IPARKTEST.PKG_FAAEI01 AS

  C_GROUP_GUEST_TYPE  CONSTANT  VARCHAR2(3) := '310'; -- 단체우대구분코드

  /*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 조회
     사용 테이블     :
    ----------------------------------------------------------------------------
     프로그램 설명   :
  ============================================================================*/
  PROCEDURE PR_01(
                     V_BIZ_CODE           IN VARCHAR2
                    ,V_EVENT_NO           IN VARCHAR2
                    ,V_RS01              OUT RS  --마스터
                    ,V_RS10              OUT RS  --전체
                    ,V_RS11              OUT RS  --객실
                    ,V_RS12              OUT RS  --식음
                    ,V_RS13              OUT RS  --워터파크
                    ,V_RS14              OUT RS  --연회장
                    ,V_RS15              OUT RS  --기타
                    ,V_RS16              OUT RS  --골프
                    ,V_RS17              OUT RS  --부대시설
                    ,V_RS18              OUT RS  --해수찜
                 )
  IS
    pCNT                    NUMBER;
    pTM_TERM                VARCHAR2(4);

  BEGIN

    OPEN V_RS01 FOR
      --마스터
      SELECT T1.EVENT_NO
            ,T1.EVENT_NAME
            ,T1.EVENT_CODE
            ,T1.AREA_CODE
            ,T1.MARKET_CODE
            ,T1.MEMBER_NO
            ,T2.MEMBER_NAME_KOR
            ,T1.DATE_FROM
            ,T1.DATE_TO
            ,T1.CUST_PART_NAME
            ,T1.CUST_EMP_NAME
            ,T1.CUST_TEL_NO
            ,T1.CUST_MOBILE_NO
            ,T1.CUST_FAX_NO
            ,T1.CUST_EMAIL
            ,T1.ADULT_CNT
            ,T1.CHILD_CNT
            ,T1.PRE_AMT
            ,T1.CONTRACT_AMT
            ,T1.ACCEPT_DATE
            ,T1.CONFIRM_DATE
            ,T1.CANCEL_DATE
            ,T1.FINISH_DATE
            ,T1.CHANGE_DATE
            ,T1.CHARGE_CODE
            ,T1.SAVE_CNT
            ,T1.CONFIRM_EMP_NO
            ,DECODE(T1.CONFIRM_EMP_NO, '', '', T3.SALE_EMP_NAME) AS CONFIRM_EMP_NAME
            ,NVL(T3.HOME_TEL_NO, T3.OFFICE_TEL_NO) AS CONFIRM_TEL
            ,T3.MOBILE_TEL AS CONFIRM_MOBILE_TEL
            ,T1.CONTRACT_EMP_NO
            ,DECODE(T1.CONTRACT_EMP_NO, '', '', T4.SALE_EMP_NAME) AS CONTRACT_EMP_NAME
            ,T4.MOBILE_TEL AS CONTRACT_MOBILE_TEL
            ,NVL(T4.HOME_TEL_NO, T4.OFFICE_TEL_NO) AS CONTRACT_TEL
            ,T1.FACING_EMP_NO
            ,DECODE(T1.FACING_EMP_NO, '', '', T5.SALE_EMP_NAME ) AS FACING_EMP_NAME
            ,NVL(T5.HOME_TEL_NO, T5.OFFICE_TEL_NO) AS FACING_TEL
            ,T5.MOBILE_TEL AS FACING_MOBILE_TEL
            ,T1.LEVEL_APPROVE
            ,T1.RMRK
            ,(SELECT ITEM1
                FROM ZXA010MS
               WHERE BIZ_CODE = T3.BIZ_CODE
                 AND HEAD = 'F0012'
                 AND DETAIL = T3.LEVEL_CODE
             ) AS CONFIRM_YN -- 결제권한
        FROM FAA010MS T1
       INNER JOIN BBA001VE T2
          ON T1.BIZ_CODE = T2.BIZ_CODE
         AND T1.MEMBER_NO = T2.MEMBER_NO
         AND T2.USE_YN_B = 'Y'
        LEFT OUTER JOIN ADA010MS T3  --T1.CONFIRM_EMP_NO
          ON T1.BIZ_CODE = T3.BIZ_CODE
         AND T1.CONFIRM_EMP_NO = T3.SALE_EMP_NO
        LEFT OUTER JOIN ADA010MS T4  --T1.CONTRACT_EMP_NO
          ON T1.BIZ_CODE = T4.BIZ_CODE
         AND T1.CONTRACT_EMP_NO = T4.SALE_EMP_NO
        LEFT OUTER JOIN ADA010MS T5
          ON T1.BIZ_CODE = T5.BIZ_CODE
         AND T1.FACING_EMP_NO = T5.SALE_EMP_NO
       WHERE (T1.BIZ_CODE = V_BIZ_CODE)
         AND (T1.EVENT_NO = V_EVENT_NO)
      ;

    --전체
    OPEN V_RS10 FOR
        SELECT
            T1.EVENT_NO              AS EVENT_NO,
            T2.SALE_AMT              AS ROOM_AMT, --객실
            A.SALE_AMT_TOT           AS FB_AMT,   --식음
            B.SALE_AMT_TOT           AS WP_AMT,   --워터 파크
            C.SALE_AMT_TOT           AS BQ_AMT,   --연회장
            NVL(A.SALE_AMT_TOT,0)
            + NVL(B.SALE_AMT_TOT,0)
            + NVL(C.SALE_AMT_TOT,0)
            + NVL(D.SALE_AMT_TOT,0)
            + NVL(E.SALE_AMT_TOT,0)
            + NVL(F.SALE_AMT_TOT,0)
            + NVL(T2.SALE_AMT,0)     AS TOT_AMT,  --전체
            D.SALE_AMT_TOT           AS ETC_AMT,  --기타
            E.SALE_AMT_TOT           AS FCT_AMT,  --부대시설
            F.SALE_AMT_TOT           AS THP_AMT   --해수찜
        FROM  FAA010MS T1
        LEFT  OUTER JOIN
                        (
                        SELECT
                            sum(SALE_AMT*PERSON_CNT)  AS SALE_AMT_TOT  , BIZ_CODE
                        FROM FAA013MS
                        WHERE (BIZ_CODE   = V_BIZ_CODE)
                            AND (EVENT_NO   = V_EVENT_NO)
                            AND FUNC_CODE = '001'
                        group BY BIZ_CODE
                        )A   ON  A.BIZ_CODE=T1.BIZ_CODE
        LEFT OUTER JOIN
                        (
                        SELECT
                        sum(sale_amt*PERSON_CNT)-(sum(sale_amt)*sum(PERSON_CNT))*avg(SALE_RATE)/100   AS SALE_AMT_TOT,BIZ_CODE
                        FROM FAA013MS
                            WHERE (BIZ_CODE   = V_BIZ_CODE)
                            AND (EVENT_NO   = V_EVENT_NO)
                            AND FUNC_CODE = '002'
                        group BY BIZ_CODE
                        )B ON  B.BIZ_CODE=T1.BIZ_CODE
        LEFT OUTER JOIN
                        (
                        SELECT
                            sum(SALE_AMT*PERSON_CNT) AS SALE_AMT_TOT,BIZ_CODE
                        FROM FAA012MS
                            WHERE (BIZ_CODE   =V_BIZ_CODE)
                            AND (EVENT_NO   = V_EVENT_NO)
                            group BY BIZ_CODE
                        )C ON C.BIZ_CODE=T1.BIZ_CODE
        LEFT OUTER JOIN
                        (
                        SELECT
                            sum(SALE_AMT*PERSON_CNT)  AS SALE_AMT_TOT,BIZ_CODE
                        FROM FAA013MS
                            WHERE (BIZ_CODE   = V_BIZ_CODE)
                            AND (EVENT_NO   = V_EVENT_NO)
                            AND FUNC_CODE = '900'
                        group BY BIZ_CODE
                        )D ON D.BIZ_CODE=T1.BIZ_CODE
        LEFT OUTER JOIN
                        (
                        SELECT
                            sum(SALE_AMT*PERSON_CNT)  AS SALE_AMT_TOT,BIZ_CODE
                        FROM FAA013MS
                            WHERE (BIZ_CODE   = V_BIZ_CODE)
                            AND (EVENT_NO   = V_EVENT_NO)
                            AND FUNC_CODE = '003'
                        group BY BIZ_CODE
                        )E ON E.BIZ_CODE=T1.BIZ_CODE
        LEFT OUTER JOIN
                        (
                        SELECT
                            sum(SALE_AMT*PERSON_CNT)  AS SALE_AMT_TOT,BIZ_CODE
                        FROM FAA013MS
                            WHERE (BIZ_CODE   = V_BIZ_CODE)
                            AND (EVENT_NO   = V_EVENT_NO)
                            AND FUNC_CODE = '004'
                        group BY BIZ_CODE
                        )F ON F.BIZ_CODE=T1.BIZ_CODE
        LEFT OUTER JOIN
                        (
                        SELECT
                            sum(SALE_AMT) AS SALE_AMT,BIZ_CODE
                        FROM FAA011MS
                            WHERE (BIZ_CODE   = V_BIZ_CODE)
                             AND (EVENT_NO   = V_EVENT_NO)
                             GROUP BY BIZ_CODE
                         )T2 ON T2.BIZ_CODE=T1.BIZ_CODE
       WHERE (T1.BIZ_CODE   =V_BIZ_CODE)
         AND (EVENT_NO   = V_EVENT_NO)
       GROUP BY
             T1.EVENT_NO
            ,T2.SALE_AMT
            ,A.SALE_AMT_TOT
            ,B.SALE_AMT_TOT
            ,C.SALE_AMT_TOT
            ,D.SALE_AMT_TOT
            ,E.SALE_AMT_TOT
            ,F.SALE_AMT_TOT;

    --객실
    OPEN V_RS11 FOR
      SELECT T1.EVENT_NO,                                                                                  --연회번호(숨김)
             T1.KEY_SEQ,                                                                                   --순번(숨김)
             T1.STATUS_CODE,                                                                               --사용여부
             T1.CHECKIN_DATE,
             TO_CHAR(TO_DATE(T1.CHECKIN_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS CHECKIN_DATE_MASK,                          --입실일자
             T1.NIGHTS,                                                                                    --박수
             TO_CHAR(TO_DATE(T1.CHECKIN_DATE, 'YYYYMMDD') + TO_NUMBER(T1.NIGHTS), 'YYYYMMDD') AS CHECKOUT_DATE,
             TO_CHAR(TO_DATE(T1.CHECKIN_DATE, 'YYYYMMDD') + TO_NUMBER(T1.NIGHTS), 'YYYY-MM-DD') AS CHECKOUT_DATE_MASK, --퇴실일자
             T1.FACILITY_CODE,
             T4.FACILITY_NAME,                                                                             --영업장
             T1.ROOM_TYPE,
             T3.ROOM_TYPE_NAME,                                                                            --객실유형
             T1.ROOM_CNT,                                                                                  --객실수
--             T1.UNIT_AMT,                                                                                  --정상단가
             (
               SELECT S1.UNIT_AMT
                 FROM JBA013MS S1
                INNER JOIN CXA010MS S2
                   ON S2.BIZ_CODE        = S1.BIZ_CODE
                  AND S2.FACILITY_CODE   = S1.FACILITY_CODE
                WHERE S2.CALN_DATE       = T1.CHECKIN_DATE
                  AND S1.BIZ_CODE        = T1.BIZ_CODE
                  AND S1.FACILITY_CODE   = T1.FACILITY_CODE
                  AND S1.MENU_CODE       = 'D1001'
                  AND S1.MENU_ITEM1      = S2.SEASON_CODE
                  AND S1.MENU_ITEM2      = T1.GUEST_TYPE --C_GROUP_GUEST_TYPE
                  AND S1.MENU_ITEM3      = T1.ROOM_TYPE
                  AND S1.MENU_ITEM4      = '1'
                  AND S1.MENU_ITEM5      = 'XX'
                  AND T1.CHECKIN_DATE    BETWEEN S1.DATE_FROM AND S1.DATE_TO
             ) AS "UNIT_AMT",                                                                              --정상금액
             T1.UNIT_AMT AS "APPLY_AMT",                                                                   --적용금액
             T1.SALE_AMT_DAY,                                                                              --판매(주중)
             T1.SALE_AMT_WEEKEND,                                                                          --판매(주말)
             T1.SALE_AMT AS SALE_AMT_TOT,                                                                  --판매금액
             T1.RSV_NO,                                                                                    --예약번호
             --NVL((SELECT ROOM_NO
             NVL((SELECT LISTAGG(ROOM_NO, ', ') WITHIN GROUP(ORDER BY ROOM_NO)
                    FROM DAA010MS
                   WHERE MNG_NO = (SELECT MNG_NO FROM DZA900MS WHERE RSV_NO = T1.RSV_NO)),
              (SELECT LISTAGG(A1.ROOM_NO, ', ') WITHIN GROUP(ORDER BY A1.ROOM_NO)
                FROM (
                      SELECT DISTINCT S1.BIZ_CODE
                           , S1.FACILITY_CODE
                           , S1.ROOM_NO
                        FROM DAA100MS S1
                       INNER JOIN
                          DZA020MS S2
                          ON S1.BIZ_CODE 			= S2.BIZ_CODE
                         AND S1.FACILITY_CODE = S2.FACILITY_CODE
                         AND S1.FACI_PART 		= S2.FACI_PART
                         AND S1.ROOM_NO   		= S2.ROOM_NO
                       WHERE S1.BIZ_CODE  		= T1.BIZ_CODE
                         AND S1.FACILITY_CODE = NVL(T1.FACILITY_CODE, S1.FACILITY_CODE)
                         AND S1.RSV_NO    		IS NOT NULL
                         AND S1.RSV_NO				= T1.RSV_NO
                      ) A1
             )) AS ROOM_NO,
             PKG_UDF.RSV_NO_OUT(T1.RSV_NO) AS RSV_NO_OUT,                                                  --예약번호(표시명)
             T1.CONFIRM,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0013'
                 AND DETAIL = T1.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             T1.REVISE,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0014'
                 AND DETAIL = T1.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             T1.RMRK,                                                                                      --객실비고(숨김)
             T6.SIGN_EMP_NO,
             (SELECT EMP_NAME
                FROM ZAA010MS
               WHERE EMP_NO = T6.SIGN_EMP_NO) ||
             DECODE(T6.SIGN_EMP_NO, NULL, NULL,'(')||
             T6.U_DATE||DECODE(T6.SIGN_EMP_NO, NULL, NULL,')')||T6.RMRK AS SIGN_INFO                      --확인정보(확인사원, 확인일자, 확인비고)
           , T1.ADULT_CNT
           , T1.CHILD_CNT
           , T1.GUEST_TYPE
           , FN_GET_CODE_NAME(T1.BIZ_CODE, 'Z0006', T1.GUEST_TYPE) AS GUEST_TYPE_NAME
           , T1.GUEST_NAME
           , T1.TPR_HARD_CNT
           , T1.TPR_RGLR_CNT
           , T1.TPR_SOFT_CNT
           , T1.CARD_CO_CODE
           , T1.CARD_NO
           , T1.VALID_THRU
           , NVL(T1.FIXED_RATE_YN, 'N') AS FIXED_RATE_YN -- FIXED RATE YN 추가(02-23)
           , NVL((
               SELECT SUM(S1.RSV_AMT)
                 FROM CBA010MS S1
                WHERE S1.RSV_NO     = T1.RSV_NO
                  AND S1.AMT_STATUS = '2'
             ), 0) AS "RSV_AMT"
           --> 2018-02-22 트레이스 번호 추가
           , (
             SELECT TRACE_MGNO
               FROM CAA010MS
              WHERE RSV_NO = T1.RSV_NO
              ) AS "TRACE_MGNO"
        FROM FAA011MS T1
       INNER JOIN FAA010MS T2
          ON T1.BIZ_CODE = T2.BIZ_CODE
         AND T1.EVENT_NO = T2.EVENT_NO
       INNER JOIN DZA023MS T3
          ON T1.BIZ_CODE = T3.BIZ_CODE
         AND T1.FACILITY_CODE = T3.FACILITY_CODE
         AND T1.ROOM_TYPE = T3.ROOM_TYPE
       INNER JOIN JAA010MS T4
          ON T1.BIZ_CODE = T4.BIZ_CODE
         AND T1.FACILITY_CODE = T4.FACILITY_CODE
        LEFT OUTER JOIN ADA010MS T5
          ON T2.BIZ_CODE = T5.BIZ_CODE
         AND T2.CONTRACT_EMP_NO = T5.SALE_EMP_NO
        LEFT OUTER JOIN FAA023MS T6
          ON T1.BIZ_CODE      = T6.BIZ_CODE
         AND T1.EVENT_NO      = T6.EVENT_NO
         AND T1.FACILITY_CODE = T6.FACILITY_CODE
         AND T1.KEY_SEQ       = T6.KEY_SEQ
         AND T6.SIGN_YN       = 'Y'
       WHERE (T1.BIZ_CODE   = V_BIZ_CODE)
         AND (T1.EVENT_NO   = V_EVENT_NO)
       ORDER BY T1.KEY_SEQ
      ;

    --식음
    OPEN V_RS12 FOR
      SELECT T1.EVENT_NO,                                                                                  --연회번호(숨김)
             T1.FUNC_CODE,                                                                                 --영업장구분
             T1.KEY_SEQ,                                                                                   --순번(숨김)
             T1.STATUS_CODE,                                                                               --사용여부
             T1.ST_DATE,
             TO_CHAR(TO_DATE(T1.ST_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS ST_DATE_MASK,                                    --사용일자
             T1.ST_TIME,
             SUBSTR(T1.ST_TIME,1,2)||':'||SUBSTR(T1.ST_TIME,3,2) AS ST_TIME_MASK,                          --시간
             T1.FACILITY_CODE,
             T3.FACILITY_NAME,                                                                             --영업장
             T1.MENU_CODE,
             T5.MENU_NAME,                                                                                 --메뉴명
             T1.UNIT_AMT,                                                                                  --정상단가
             T1.SALE_AMT,                                                                                  --판매단가
             T1.PERSON_CNT,                                                                                --보증인원
             T1.PLAN_CNT,                                                                                  --예상인원
             T1.SALE_AMT * T1.PERSON_CNT AS SALE_AMT_TOT,                                                  --판매금액
             T1.CONFIRM,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0013'
                 AND DETAIL = T1.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             T1.REVISE,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0014'
                 AND DETAIL = T1.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             T1.RMRK,                                                                                      --객실비고(숨김)
             T6.SIGN_EMP_NO,
             (SELECT EMP_NAME
                FROM ZAA010MS
               WHERE EMP_NO = T6.SIGN_EMP_NO) ||
             DECODE(T6.SIGN_EMP_NO, NULL, NULL,'(')||
             T6.U_DATE||DECODE(T6.SIGN_EMP_NO, NULL, NULL,')')||T6.RMRK AS SIGN_INFO                      --확인정보(확인사원, 확인일자, 확인비고)
        FROM FAA013MS T1
       INNER JOIN FAA010MS T2
          ON T1.BIZ_CODE  = T2.BIZ_CODE
         AND T1.EVENT_NO  = T2.EVENT_NO
         AND T1.FUNC_CODE = '001'
       INNER JOIN JAA010MS T3
          ON T1.BIZ_CODE = T3.BIZ_CODE
         AND T1.FACILITY_CODE = T3.FACILITY_CODE
        LEFT OUTER JOIN ADA010MS T4
          ON T2.BIZ_CODE = T4.BIZ_CODE
         AND T2.CONTRACT_EMP_NO = T4.SALE_EMP_NO
        LEFT OUTER JOIN JBA010MS T5
          ON T1.BIZ_CODE = T5.BIZ_CODE
         AND T1.MENU_CODE = T5.MENU_CODE
        LEFT OUTER JOIN FAA023MS T6
          ON T1.BIZ_CODE      = T6.BIZ_CODE
         AND T1.EVENT_NO      = T6.EVENT_NO
         AND T1.FACILITY_CODE = T6.FACILITY_CODE
         AND T1.KEY_SEQ       = T6.KEY_SEQ
       WHERE (T1.BIZ_CODE   = V_BIZ_CODE)
         AND (T1.EVENT_NO   = V_EVENT_NO)
       ORDER BY T1.KEY_SEQ
    ;

    --워터파크
    OPEN V_RS13 FOR
      SELECT T1.EVENT_NO,                                                                                  --연회번호(숨김)
             T1.FUNC_CODE,                                                                                 --영업장구분
             T1.KEY_SEQ,                                                                                   --순번(숨김)
             T1.STATUS_CODE,                                                                               --사용여부
             T1.ST_DATE,
             TO_CHAR(TO_DATE(T1.ST_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS ST_DATE_MASK,                                    --사용일자
             T1.ST_TIME,
             SUBSTR(T1.ST_TIME,1,2)||':'||SUBSTR(T1.ST_TIME,3,2) AS ST_TIME_MASK,                          --시간
             T1.FACILITY_CODE,
             T3.FACILITY_NAME,                                                                             --영업장
             T1.MENU_CODE,
             T5.MENU_NAME,                                                                                 --메뉴명
             T1.UNIT_AMT,                                                                                  --정상단가
             T1.SALE_AMT,                                                                                  --판매단가
             T1.PERSON_CNT,                                                                                --보증인원
             T1.PLAN_CNT,                                                                                  --예상인원
             T1.SALE_AMT * T1.PERSON_CNT AS SALE_AMT_TOT,                                                  --판매금액
             T1.CONFIRM,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0013'
                 AND DETAIL = T1.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             T1.REVISE,
             T1.SALE_RATE,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0014'
                 AND DETAIL = T1.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             T1.RMRK,                                                                                      --객실비고(숨김)
             T6.SIGN_EMP_NO,
             (SELECT EMP_NAME
                FROM ZAA010MS
               WHERE EMP_NO = T6.SIGN_EMP_NO) ||
             DECODE(T6.SIGN_EMP_NO, NULL, NULL,'(')||
             T6.U_DATE||DECODE(T6.SIGN_EMP_NO, NULL, NULL,')')||T6.RMRK AS SIGN_INFO                      --확인정보(확인사원, 확인일자, 확인비고)
        FROM FAA013MS T1
       INNER JOIN FAA010MS T2
          ON T1.BIZ_CODE  = T2.BIZ_CODE
         AND T1.EVENT_NO  = T2.EVENT_NO
         AND T1.FUNC_CODE = '002'
       INNER JOIN JAA010MS T3
          ON T1.BIZ_CODE = T3.BIZ_CODE
         AND T1.FACILITY_CODE = T3.FACILITY_CODE
        LEFT OUTER JOIN ADA010MS T4
          ON T2.BIZ_CODE = T4.BIZ_CODE
         AND T2.CONTRACT_EMP_NO = T4.SALE_EMP_NO
        LEFT OUTER JOIN JBA010MS T5
          ON T1.BIZ_CODE = T5.BIZ_CODE
         AND T1.MENU_CODE = T5.MENU_CODE
        LEFT OUTER JOIN FAA023MS T6
          ON T1.BIZ_CODE      = T6.BIZ_CODE
         AND T1.EVENT_NO      = T6.EVENT_NO
         AND T1.FACILITY_CODE = T6.FACILITY_CODE
         AND T1.KEY_SEQ       = T6.KEY_SEQ
       WHERE (T1.BIZ_CODE   = V_BIZ_CODE)
         AND (T1.EVENT_NO   = V_EVENT_NO)
       ORDER BY T1.KEY_SEQ
    ;

    --연회장
    OPEN V_RS14 FOR
      SELECT T1.EVENT_NO,                                                                                  --연회번호(숨김)
             T1.KEY_SEQ,                                                                                   --순번(숨김)
             T1.STATUS_CODE,                                                                               --사용여부
             T1.ST_DATE,
             TO_CHAR(TO_DATE(T1.ST_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS ST_DATE_MASK,                        --사용일자
             T1.ST_TIME,
             SUBSTR(T1.ST_TIME,1,2)||':'||SUBSTR(T1.ST_TIME,3,2) AS ST_TIME_MASK,                          --시작시간
             T1.END_DATE,
             TO_CHAR(TO_DATE(T1.END_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS END_DATE_MASK,                      --종료일자
             T1.END_TIME,
             SUBSTR(T1.END_TIME,1,2)||':'||SUBSTR(T1.END_TIME,3,2) AS END_TIME_MASK,                       --종료시간
             SUBSTR(T1.ST_TIME,1,2)||':'||SUBSTR(T1.ST_TIME,3,2) || '~'
             || SUBSTR(T1.END_TIME,1,2)||':'||SUBSTR(T1.END_TIME,3,2) AS TIME_MASK,                        --시간
             T1.MENU_CODE,
             T5.MENU_NAME,                                                                                 --메뉴명
             T1.FACILITY_CODE,
             T3.FACILITY_NAME,                                                                             --영업장
             T1.UNIT_AMT,                                                                                  --정상단가
             T1.SALE_AMT,                                                                                  --판매단가
             T1.PERSON_CNT,                                                                                --보증인원
             T1.TABLE_SET,
             T1.SALE_AMT * T1.PERSON_CNT AS SALE_AMT_TOT,                                                  --판매금액
             T1.RSV_STATUS,
             T1.CONFIRM,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0013'
                 AND DETAIL = T1.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             T1.REVISE,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0014'
                 AND DETAIL = T1.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             T1.RMRK,                                                                                      --객실비고(숨김)
             T6.SIGN_EMP_NO,
             (SELECT EMP_NAME
                FROM ZAA010MS
               WHERE EMP_NO = T6.SIGN_EMP_NO) ||
             DECODE(T6.SIGN_EMP_NO, NULL, NULL,'(')||
             T6.U_DATE||DECODE(T6.SIGN_EMP_NO, NULL, NULL,')')||T6.RMRK AS SIGN_INFO                      --확인정보(확인사원, 확인일자, 확인비고)
          FROM FAA012MS T1
         INNER JOIN FAA010MS T2
            ON T1.BIZ_CODE  = T2.BIZ_CODE
           AND T1.EVENT_NO  = T2.EVENT_NO
         INNER JOIN JAA010MS T3
            ON T1.BIZ_CODE = T3.BIZ_CODE
           AND T1.FACILITY_CODE = T3.FACILITY_CODE
          LEFT OUTER JOIN ADA010MS T4
            ON T2.BIZ_CODE = T4.BIZ_CODE
           AND T2.CONTRACT_EMP_NO = T4.SALE_EMP_NO
          LEFT OUTER JOIN JBA010MS T5
            ON T1.BIZ_CODE      = T5.BIZ_CODE
           AND T1.MENU_CODE     = T5.MENU_CODE
          LEFT OUTER JOIN FAA023MS T6
            ON T1.BIZ_CODE      = T6.BIZ_CODE
           AND T1.EVENT_NO      = T6.EVENT_NO
           AND T1.FACILITY_CODE = T6.FACILITY_CODE
           AND T1.KEY_SEQ       = T6.KEY_SEQ
         WHERE T1.BIZ_CODE   = V_BIZ_CODE
           AND T1.EVENT_NO = V_EVENT_NO
         ORDER BY T1.KEY_SEQ
       ;

    --기타
    OPEN V_RS15 FOR
      SELECT T1.EVENT_NO,
             T1.FUNC_CODE,                                                                                 --연회번호(숨김)
             T1.KEY_SEQ,                                                                                   --순번(숨김)
             T1.STATUS_CODE,                                                                               --사용여부
             T1.ST_DATE,
             TO_CHAR(TO_DATE(T1.ST_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS ST_DATE_MASK,                                    --사용일자
             T1.ST_TIME,
             SUBSTR(T1.ST_TIME,1,2)||':'||SUBSTR(T1.ST_TIME,3,2) AS ST_TIME_MASK,                          --시간
             T1.FACILITY_CODE,
             T3.FACILITY_NAME,                                                                             --영업장
             T1.MENU_CODE,
             T5.MENU_NAME,                                                                                 --메뉴명
             T1.UNIT_AMT,                                                                                  --정상단가
             T1.SALE_AMT,                                                                                  --판매단가
             T1.PERSON_CNT,                                                                                --보증인원
             T1.PLAN_CNT,                                                                                  --예상인원
             T1.SALE_AMT * T1.PERSON_CNT AS SALE_AMT_TOT,                                                  --판매금액
             T1.CONFIRM,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0013'
                 AND DETAIL = T1.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             T1.REVISE,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0014'
                 AND DETAIL = T1.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             T1.RMRK,                                                                                      --객실비고(숨김)
             T6.SIGN_EMP_NO,
             (SELECT EMP_NAME
                FROM ZAA010MS
               WHERE EMP_NO = T6.SIGN_EMP_NO) ||
             DECODE(T6.SIGN_EMP_NO, NULL, NULL,'(')||
             T6.U_DATE||DECODE(T6.SIGN_EMP_NO, NULL, NULL,')')||T6.RMRK AS SIGN_INFO                      --확인정보(확인사원, 확인일자, 확인비고)
        FROM FAA013MS T1
       INNER JOIN FAA010MS T2
          ON T1.BIZ_CODE  = T2.BIZ_CODE
         AND T1.EVENT_NO  = T2.EVENT_NO
         AND T1.FUNC_CODE = '900'
       INNER JOIN JAA010MS T3
          ON T1.BIZ_CODE = T3.BIZ_CODE
         AND T1.FACILITY_CODE = T3.FACILITY_CODE
        LEFT OUTER JOIN ADA010MS T4
          ON T2.BIZ_CODE = T4.BIZ_CODE
         AND T2.CONTRACT_EMP_NO = T4.SALE_EMP_NO
        LEFT OUTER JOIN JBA010MS T5
          ON T1.BIZ_CODE = T5.BIZ_CODE
         AND T1.MENU_CODE = T5.MENU_CODE
        LEFT OUTER JOIN FAA023MS T6
          ON T1.BIZ_CODE      = T6.BIZ_CODE
         AND T1.EVENT_NO      = T6.EVENT_NO
         AND T1.FACILITY_CODE = T6.FACILITY_CODE
         AND T1.KEY_SEQ       = T6.KEY_SEQ
       WHERE (T1.BIZ_CODE   = V_BIZ_CODE)
         AND (T1.EVENT_NO   = V_EVENT_NO)
       ORDER BY T1.KEY_SEQ
    ;

    -- 골프
    OPEN V_RS16 FOR
      SELECT A.EVENT_NO,
             A.KEY_SEQ,
             A.STATUS_CODE,
             A.TEEUP_TIME_NO,
             A.LINK_TEEUP_TIME_NO,
             PKG_HAAAI14.FN_05(I.TEEUP_TIME) AS LINK_TEEUP_TIME,
             A.HOLE_CODE,
             B.DETAIL_NAME,
             D.FACILITY_NAME,
             C.RSV_DATE,
             PKG_HAAAI14.FN_05(C.TEEUP_TIME) AS TEEUP_TIME,
             A.GUEST_TYPE,
             H.DETAIL_NAME AS GUEST_TYPE_NAME,
             A.ENTN_UNIT_AMT,
             A.RSV_CNT,
             A.ENTN_DC_RATE,
             A.ENTN_SALE_AMT,
             A.CART_UNIT_AMT,
             A.RSV_CART_CNT,
             A.CART_DC_RATE,
             A.CART_SALE_AMT,
             A.RSV_NO,
             (SELECT DETAIL_NAME
              FROM ZXA010MS
              WHERE BIZ_CODE   = A.BIZ_CODE
                    AND HEAD   = 'F0013'
                    AND DETAIL = A.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             (SELECT DETAIL_NAME
              FROM ZXA010MS
              WHERE BIZ_CODE = A.BIZ_CODE
                    AND HEAD = 'F0014'
                    AND DETAIL = A.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             (SELECT EMP_NAME
              FROM ZAA010MS
              WHERE EMP_NO = F.SIGN_EMP_NO) ||
                    DECODE(F.SIGN_EMP_NO, NULL, NULL,'(') ||
                    F.U_DATE ||
                    DECODE(F.SIGN_EMP_NO, NULL, NULL,')') ||
                    F.RMRK AS SIGN_INFO,                                            --확인정보(확인사원, 확인일자, 확인비고)
             A.RMRK,
             G.SALE_CODE
        FROM FAA014MS A
             INNER JOIN ZXA010MS B ON A.BIZ_CODE = B.BIZ_CODE AND B.HEAD = 'H0003' AND A.HOLE_CODE = B.DETAIL
             INNER JOIN ZXA010MS H ON A.BIZ_CODE = H.BIZ_CODE AND H.HEAD = 'Z0006' AND A.GUEST_TYPE = H.DETAIL
             INNER JOIN HAA110MS C ON A.TEEUP_TIME_NO = C.TEEUP_TIME_NO
        LEFT OUTER JOIN HAA110MS I ON A.LINK_TEEUP_TIME_NO = I.TEEUP_TIME_NO
             INNER JOIN JAA010MS D ON C.BIZ_CODE = D.BIZ_CODE AND FACILITY_TYPE = '20' AND C.FACILITY_CODE = D.FACILITY_CODE
        LEFT OUTER JOIN HBA010MS E ON A.RSV_NO = E.RSV_NO
        LEFT OUTER JOIN FAA023MS F ON A.BIZ_CODE = F.BIZ_CODE AND A.EVENT_NO = F.EVENT_NO AND C.FACILITY_CODE = F.FACILITY_CODE AND A.KEY_SEQ = F.KEY_SEQ AND F.SIGN_YN = 'Y'
        RIGHT OUTER JOIN HAA010MS G ON C.BIZ_CODE = G.BIZ_CODE AND C.FACILITY_CODE = G.FACILITY_CODE AND C.RSV_DATE = G.CALN_DATE
        WHERE (A.BIZ_CODE   = V_BIZ_CODE)
          AND (A.EVENT_NO   = V_EVENT_NO)
       ORDER BY A.KEY_SEQ
      ;

    --부대시설
    OPEN V_RS17 FOR
      SELECT T1.EVENT_NO,                                                                                  --연회번호(숨김)
             T1.FUNC_CODE,                                                                                 --영업장구분
             T1.KEY_SEQ,                                                                                   --순번(숨김)
             T1.STATUS_CODE,                                                                               --사용여부
             T1.ST_DATE,
             TO_CHAR(TO_DATE(T1.ST_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS ST_DATE_MASK,                                    --사용일자
             T1.ST_TIME,
             SUBSTR(T1.ST_TIME,1,2)||':'||SUBSTR(T1.ST_TIME,3,2) AS ST_TIME_MASK,                          --시간
             T1.FACILITY_CODE,
             T3.FACILITY_NAME,                                                                             --영업장
             T1.MENU_CODE,
             T5.MENU_NAME,                                                                                 --메뉴명
             T1.UNIT_AMT,                                                                                  --정상단가
             T1.SALE_AMT,                                                                                  --판매단가
             T1.PERSON_CNT,                                                                                --보증인원
             T1.PLAN_CNT,                                                                                  --예상인원
             T1.SALE_AMT * T1.PERSON_CNT AS SALE_AMT_TOT,                                                  --판매금액
             T1.CONFIRM,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0013'
                 AND DETAIL = T1.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             T1.REVISE,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0014'
                 AND DETAIL = T1.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             T1.RMRK,                                                                                      --객실비고(숨김)
             T6.SIGN_EMP_NO,
             (SELECT EMP_NAME
                FROM ZAA010MS
               WHERE EMP_NO = T6.SIGN_EMP_NO) ||
             DECODE(T6.SIGN_EMP_NO, NULL, NULL,'(')||
             T6.U_DATE||DECODE(T6.SIGN_EMP_NO, NULL, NULL,')')||T6.RMRK AS SIGN_INFO                      --확인정보(확인사원, 확인일자, 확인비고)
        FROM FAA013MS T1
       INNER JOIN FAA010MS T2
          ON T1.BIZ_CODE  = T2.BIZ_CODE
         AND T1.EVENT_NO  = T2.EVENT_NO
         AND T1.FUNC_CODE = '003'
       INNER JOIN JAA010MS T3
          ON T1.BIZ_CODE = T3.BIZ_CODE
         AND T1.FACILITY_CODE = T3.FACILITY_CODE
        LEFT OUTER JOIN ADA010MS T4
          ON T2.BIZ_CODE = T4.BIZ_CODE
         AND T2.CONTRACT_EMP_NO = T4.SALE_EMP_NO
        LEFT OUTER JOIN JBA010MS T5
          ON T1.BIZ_CODE = T5.BIZ_CODE
         AND T1.MENU_CODE = T5.MENU_CODE
        LEFT OUTER JOIN FAA023MS T6
          ON T1.BIZ_CODE      = T6.BIZ_CODE
         AND T1.EVENT_NO      = T6.EVENT_NO
         AND T1.FACILITY_CODE = T6.FACILITY_CODE
         AND T1.KEY_SEQ       = T6.KEY_SEQ
       WHERE (T1.BIZ_CODE   = V_BIZ_CODE)
         AND (T1.EVENT_NO   = V_EVENT_NO)
       ORDER BY T1.KEY_SEQ
    ;

    --해수찜
    OPEN V_RS18 FOR
      SELECT T1.EVENT_NO,                                                                                  --연회번호(숨김)
             T1.FUNC_CODE,                                                                                 --영업장구분
             T1.KEY_SEQ,                                                                                   --순번(숨김)
             T1.STATUS_CODE,                                                                               --사용여부
             T1.ST_DATE,
             TO_CHAR(TO_DATE(T1.ST_DATE, 'YYYYMMDD'),'YYYY-MM-DD') AS ST_DATE_MASK,                                    --사용일자
             T1.ST_TIME,
             SUBSTR(T1.ST_TIME,1,2)||':'||SUBSTR(T1.ST_TIME,3,2) AS ST_TIME_MASK,                          --시간
             T1.FACILITY_CODE,
             T3.FACILITY_NAME,                                                                             --영업장
             T1.MENU_CODE,
             T5.MENU_NAME,                                                                                 --메뉴명
             T1.UNIT_AMT,                                                                                  --정상단가
             T1.SALE_AMT,                                                                                  --판매단가
             T1.PERSON_CNT,                                                                                --보증인원
             T1.PLAN_CNT,                                                                                  --예상인원
             T1.SALE_AMT * T1.PERSON_CNT AS SALE_AMT_TOT,                                                  --판매금액
             T1.CONFIRM,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0013'
                 AND DETAIL = T1.CONFIRM) AS CONFIRM_NAME,                                                 --업장확인
             T1.REVISE,
             (SELECT DETAIL_NAME
                FROM ZXA010MS
               WHERE BIZ_CODE = T1.BIZ_CODE
                 AND HEAD = 'F0014'
                 AND DETAIL = T1.REVISE) AS REVISE_NAME,                                                   --자료상태(숨김)
             T1.RMRK,                                                                                      --객실비고(숨김)
             T6.SIGN_EMP_NO,
             (SELECT EMP_NAME
                FROM ZAA010MS
               WHERE EMP_NO = T6.SIGN_EMP_NO) ||
             DECODE(T6.SIGN_EMP_NO, NULL, NULL,'(')||
             T6.U_DATE||DECODE(T6.SIGN_EMP_NO, NULL, NULL,')')||T6.RMRK AS SIGN_INFO                      --확인정보(확인사원, 확인일자, 확인비고)
        FROM FAA013MS T1
       INNER JOIN FAA010MS T2
          ON T1.BIZ_CODE  = T2.BIZ_CODE
         AND T1.EVENT_NO  = T2.EVENT_NO
         AND T1.FUNC_CODE = '004'
       INNER JOIN JAA010MS T3
          ON T1.BIZ_CODE = T3.BIZ_CODE
         AND T1.FACILITY_CODE = T3.FACILITY_CODE
        LEFT OUTER JOIN ADA010MS T4
          ON T2.BIZ_CODE = T4.BIZ_CODE
         AND T2.CONTRACT_EMP_NO = T4.SALE_EMP_NO
        LEFT OUTER JOIN JBA010MS T5
          ON T1.BIZ_CODE = T5.BIZ_CODE
         AND T1.MENU_CODE = T5.MENU_CODE
        LEFT OUTER JOIN FAA023MS T6
          ON T1.BIZ_CODE      = T6.BIZ_CODE
         AND T1.EVENT_NO      = T6.EVENT_NO
         AND T1.FACILITY_CODE = T6.FACILITY_CODE
         AND T1.KEY_SEQ       = T6.KEY_SEQ
       WHERE (T1.BIZ_CODE   = V_BIZ_CODE)
         AND (T1.EVENT_NO   = V_EVENT_NO)
       ORDER BY T1.KEY_SEQ
    ;

  END PR_01;



  /*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 입력
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
   ============================================================================*/
  PROCEDURE PR_10(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NAME              IN VARCHAR2
                    ,V_EVENT_CODE              IN VARCHAR2
                    ,V_AREA_CODE               IN VARCHAR2
                    ,V_MARKET_CODE             IN VARCHAR2
                    ,V_MEMBER_NO               IN VARCHAR2
                    ,V_DATE_FROM               IN VARCHAR2
                    ,V_DATE_TO                 IN VARCHAR2
                    ,V_CUST_PART_NAME          IN VARCHAR2
                    ,V_CUST_EMP_NAME           IN VARCHAR2
                    ,V_CUST_TEL_NO             IN VARCHAR2
                    ,V_CUST_MOBILE_NO          IN VARCHAR2
                    ,V_CUST_FAX_NO             IN VARCHAR2
                    ,V_CUST_EMAIL              IN VARCHAR2
                    ,V_ADULT_CNT               IN VARCHAR2
                    ,V_CHILD_CNT               IN VARCHAR2
                    ,V_PRE_AMT                 IN VARCHAR2
                    ,V_CONTRACT_AMT            IN VARCHAR2
                    ,V_ACCEPT_DATE             IN VARCHAR2
                    ,V_CONFIRM_DATE            IN VARCHAR2
                    ,V_CANCEL_DATE             IN VARCHAR2
                    ,V_FINISH_DATE             IN VARCHAR2
                    ,V_CHANGE_DATE             IN VARCHAR2
                    ,V_CHARGE_CODE             IN VARCHAR2
                    ,V_SAVE_CNT                IN VARCHAR2
                    ,V_CONFIRM_EMP_NO          IN VARCHAR2
                    ,V_CONTRACT_EMP_NO         IN VARCHAR2
                    ,V_FACING_EMP_NO           IN VARCHAR2
                    ,V_LEVEL_APPROVE           IN VARCHAR2
                    ,V_RMRK                    IN VARCHAR2
                    ,V_GUEST_TYPE              IN VARCHAR2 --2018-07-03추가
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                    ,V_EVENT_NO               OUT VARCHAR2
                  )
   AS
   p_cust_no BBA020MS.CUST_NO%TYPE;
   BEGIN



     --연회번호 생성
     --V_EVENT_NO := PKG_EVENT.FN_201(V_BIZ_CODE, V_MEMBER_NO);

     --비회원등록 입력 호출
     PKG_ABAAI03.PR_10(
                       V_BIZ_CODE                          --IN VARCHAR2
                       --BBA020MS
                      ,V_EVENT_NAME                        --V_MEMBER_NAME_KOR         --IN VARCHAR2
                      ,NULL                                --V_MEMBER_NAME_ENG         --IN VARCHAR2
                      ,NULL                                --V_MEMBER_NAME_CHT         --IN VARCHAR2
                      ,NULL                                --V_ID_NO                   --IN VARCHAR2
                      ,'3'                                 --V_SEX_CODE                --IN VARCHAR2
                      ,'KR'                                --V_NATION_CODE             --IN VARCHAR2
                      ,NULL                                --V_BIRTH_DAY               --IN VARCHAR2
                      ,'2'                                 --V_CALENDER_CODE           --IN VARCHAR2
                      ,NULL                                --V_WEDD_DAY                --IN VARCHAR2
                      ,NULL                                --V_FOUND_DAY               --IN VARCHAR2
                      ,NULL                                --V_JOB_CODE                --IN VARCHAR2
                      ,NULL                                --V_COMPANY_NAME            --IN VARCHAR2
                      ,NULL                                --V_POST_NAME               --IN VARCHAR2
                      ,NULL                                --V_OFFICE_POSITION         --IN VARCHAR2
                      ,NULL                                --V_E_MAIL                  --IN VARCHAR2
                      ,NULL                                --V_HOME_TEL                --IN VARCHAR2
                      ,NULL                                --V_HOME_FAX                --IN VARCHAR2
                      ,NULL                                --V_OFFICE_TEL              --IN VARCHAR2
                      ,NULL                                --V_OFFICE_FAX              --IN VARCHAR2
                      ,NULL                                --V_MOBILE_TEL              --IN VARCHAR2
                      ,'N'                                 --V_SMS_YN                  --IN VARCHAR2
                      ,'N'                                 --V_EMS_YN                  --IN VARCHAR2
                      ,'X'                                 --V_DM_CODE                 --IN VARCHAR2
                      ,NULL                                --V_HOME_POST               --IN VARCHAR2
                      ,NULL                                --V_HOME_ADDRESS1           --IN VARCHAR2
                      ,NULL                                --V_HOME_ADDRESS2           --IN VARCHAR2
                      ,NULL                                --V_OFFICE_POST             --IN VARCHAR2
                      ,NULL                                --V_OFFICE_ADDRESS1         --IN VARCHAR2
                      ,NULL                                --V_OFFICE_ADDRESS2         --IN VARCHAR2
                      ,'Y'                                 --V_USE_YN                  --IN VARCHAR2
                      ,NULL                                --V_RMRK                    --IN VARCHAR2
                      --BBA010MS
                      --,V_MEMBER_SEQ                      --IN VARCHAR2
                      --,V_CUST_NO                         --IN VARCHAR2
                      --,V_CAP_MEMBER_NO                   --IN VARCHAR2
                      ,'41'--V_MEMBER_GROUP_CODE           --IN VARCHAR2
                      --,C_GROUP_GUEST_TYPE --'301'--V_GUEST_TYPE                 --IN VARCHAR2
                      --2018-07-03
                      ,V_GUEST_TYPE --'301'--V_GUEST_TYPE                 --IN VARCHAR2
                      ,TO_CHAR(TO_DATE(SYSDATE),'YYYYMMDD')--V_ENTR_DATE               --IN VARCHAR2
                      --,V_PSWD                            --IN VARCHAR2
                      --BBA011MS T3
                      --,V_MEMBER_NO                       --IN VARCHAR2
                      --,V_MEMBER_SEQ                      --IN VARCHAR2
                      --BAA030MS T4
                      --,V_MEMBER_SEQ                      --IN VARCHAR2
                      ,V_DATE_FROM                         --V_USE_DATE_FROM           --IN VARCHAR2
                      ,V_DATE_TO                           --V_USE_DATE_TO             --IN VARCHAR2
                      ,NULL                                --인사연동관련 사원번호 INPUT 필드
                      ,NULL
                      ,V_EMP_NO                            --IN VARCHAR2
                      ,V_IP                                --IN VARCHAR2
                      ,V_RET                               --OUT VARCHAR2
                      ,p_cust_no                           --OUT VARCHAR2
                      ,V_EVENT_NO                          --OUT VARCHAR2
                     );
     IF (V_RET != 'OK') THEN
       RETURN;
     END IF;

     INSERT INTO FAA010MS
            (
             BIZ_CODE
            ,EVENT_NO
            ,EVENT_NAME
            ,EVENT_CODE
            ,AREA_CODE
            ,MARKET_CODE
            ,MEMBER_NO
            ,DATE_FROM
            ,DATE_TO
            ,CUST_PART_NAME
            ,CUST_EMP_NAME
            ,CUST_TEL_NO
            ,CUST_MOBILE_NO
            ,CUST_FAX_NO
            ,CUST_EMAIL
            ,ADULT_CNT
            ,CHILD_CNT
            ,PRE_AMT
            ,CONTRACT_AMT
            ,ACCEPT_DATE
            ,CONFIRM_DATE
            ,CANCEL_DATE
            ,FINISH_DATE
            ,CHANGE_DATE
            ,CHARGE_CODE
            ,SAVE_CNT
            ,CONFIRM_EMP_NO
            ,CONTRACT_EMP_NO
            ,FACING_EMP_NO
            ,LEVEL_APPROVE
            ,RMRK
            ,U_EMP_NO
            ,U_DATE
            ,U_IP
            )
     VALUES
            (
             V_BIZ_CODE
            ,V_EVENT_NO
            ,V_EVENT_NAME
            ,V_EVENT_CODE
            ,V_AREA_CODE
            ,V_MARKET_CODE
            ,V_MEMBER_NO
            ,V_DATE_FROM
            ,V_DATE_TO
            ,V_CUST_PART_NAME
            ,V_CUST_EMP_NAME
            ,V_CUST_TEL_NO
            ,V_CUST_MOBILE_NO
            ,V_CUST_FAX_NO
            ,V_CUST_EMAIL
            ,V_ADULT_CNT
            ,V_CHILD_CNT
            ,V_PRE_AMT
            ,V_CONTRACT_AMT
            ,NVL(V_ACCEPT_DATE, TO_CHAR(SYSDATE, 'YYYYMMDD'))
            ,V_CONFIRM_DATE
            ,V_CANCEL_DATE
            ,V_FINISH_DATE
            ,V_CHANGE_DATE
            ,V_CHARGE_CODE
            ,V_SAVE_CNT
            ,V_CONFIRM_EMP_NO
            ,V_CONTRACT_EMP_NO
            ,V_FACING_EMP_NO
            ,'001'  --V_LEVEL_APPROVE
            ,V_RMRK
            ,V_EMP_NO
            ,SYSDATE
            ,V_IP
            )
     ;

     V_RET := 'OK';

     RETURN;

     EXCEPTION
     WHEN OTHERS  THEN
          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_10]';
   END PR_10;

  /*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 수정
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
  ============================================================================*/
   PROCEDURE PR_11(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NO                IN VARCHAR2
                    ,V_EVENT_NAME              IN VARCHAR2
                    ,V_EVENT_CODE              IN VARCHAR2
                    ,V_AREA_CODE               IN VARCHAR2
                    ,V_MARKET_CODE             IN VARCHAR2
                    ,V_MEMBER_NO               IN VARCHAR2
                    ,V_DATE_FROM               IN VARCHAR2
                    ,V_DATE_TO                 IN VARCHAR2
                    ,V_CUST_PART_NAME          IN VARCHAR2
                    ,V_CUST_EMP_NAME           IN VARCHAR2
                    ,V_CUST_TEL_NO             IN VARCHAR2
                    ,V_CUST_MOBILE_NO          IN VARCHAR2
                    ,V_CUST_FAX_NO             IN VARCHAR2
                    ,V_CUST_EMAIL              IN VARCHAR2
                    ,V_ADULT_CNT               IN VARCHAR2
                    ,V_CHILD_CNT               IN VARCHAR2
                    ,V_PRE_AMT                 IN VARCHAR2
                    ,V_CONTRACT_AMT            IN VARCHAR2
                    ,V_ACCEPT_DATE             IN VARCHAR2
                    ,V_CONFIRM_DATE            IN VARCHAR2
                    ,V_CANCEL_DATE             IN VARCHAR2
                    ,V_FINISH_DATE             IN VARCHAR2
                    ,V_CHANGE_DATE             IN VARCHAR2
                    ,V_CHARGE_CODE             IN VARCHAR2
                    ,V_SAVE_CNT                IN VARCHAR2
                    ,V_CONFIRM_EMP_NO          IN VARCHAR2
                    ,V_CONTRACT_EMP_NO         IN VARCHAR2
                    ,V_FACING_EMP_NO           IN VARCHAR2
                    ,V_LEVEL_APPROVE           IN VARCHAR2
                    ,V_RMRK                    IN VARCHAR2
                    ,V_GUEST_TYPE              IN VARCHAR2 --2018-07-03
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                  )
   AS
   p_key_seq      FAA010HS.KEY_SEQ%TYPE  := 0;
   p_save_cnt     FAA010MS.SAVE_CNT%TYPE := 0;
   p_rt           BBA001VE%ROWTYPE;
   BEGIN

     --업데이트 전 이력입력
     SELECT NVL(MAX(KEY_SEQ),0) + 1
       INTO p_key_seq
       FROM FAA010HS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     INSERT INTO FAA010HS
            (
             BIZ_CODE
            ,EVENT_NO
            ,KEY_SEQ
            ,EVENT_NAME
            ,EVENT_CODE
            ,AREA_CODE
            ,MARKET_CODE
            ,MEMBER_NO
            ,DATE_FROM
            ,DATE_TO
            ,CUST_PART_NAME
            ,CUST_EMP_NAME
            ,CUST_TEL_NO
            ,CUST_MOBILE_NO
            ,CUST_FAX_NO
            ,CUST_EMAIL
            ,ADULT_CNT
            ,CHILD_CNT
            ,PRE_AMT
            ,CONTRACT_AMT
            ,ACCEPT_DATE
            ,CONFIRM_DATE
            ,CANCEL_DATE
            ,FINISH_DATE
            ,CHANGE_DATE
            ,CHARGE_CODE
            ,SAVE_CNT
            ,CONFIRM_EMP_NO
            ,CONTRACT_EMP_NO
            ,FACING_EMP_NO
            ,LEVEL_APPROVE
            ,RMRK
            ,U_EMP_NO
            ,U_DATE
            ,U_IP
            )
     SELECT BIZ_CODE
           ,EVENT_NO
           ,p_key_seq
           ,EVENT_NAME
           ,EVENT_CODE
           ,AREA_CODE
           ,MARKET_CODE
           ,MEMBER_NO
           ,DATE_FROM
           ,DATE_TO
           ,CUST_PART_NAME
           ,CUST_EMP_NAME
           ,CUST_TEL_NO
           ,CUST_MOBILE_NO
           ,CUST_FAX_NO
           ,CUST_EMAIL
           ,ADULT_CNT
           ,CHILD_CNT
           ,PRE_AMT
           ,CONTRACT_AMT
           ,ACCEPT_DATE
           ,CONFIRM_DATE
           ,CANCEL_DATE
           ,FINISH_DATE
           ,CHANGE_DATE
           ,CHARGE_CODE
           ,SAVE_CNT
           ,CONFIRM_EMP_NO
           ,CONTRACT_EMP_NO
           ,FACING_EMP_NO
           ,LEVEL_APPROVE
           ,RMRK
           ,U_EMP_NO
           ,U_DATE
           ,U_IP
       FROM FAA010MS
      WHERE (BIZ_CODE = V_BIZ_CODE)
        AND (EVENT_NO = V_EVENT_NO)
     ;

     --업데이트
     SELECT NVL(MAX(SAVE_CNT),0)+1
       INTO p_save_cnt
       FROM FAA010MS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     UPDATE FAA010MS
        SET EVENT_NAME       = V_EVENT_NAME
           ,EVENT_CODE       = V_EVENT_CODE
           ,AREA_CODE        = V_AREA_CODE
           ,MARKET_CODE      = V_MARKET_CODE
           ,MEMBER_NO        = V_MEMBER_NO
           ,DATE_FROM        = V_DATE_FROM
           ,DATE_TO          = V_DATE_TO
           ,CUST_PART_NAME   = V_CUST_PART_NAME
           ,CUST_EMP_NAME    = V_CUST_EMP_NAME
           ,CUST_TEL_NO      = V_CUST_TEL_NO
           ,CUST_MOBILE_NO   = V_CUST_MOBILE_NO
           ,CUST_FAX_NO      = V_CUST_FAX_NO
           ,CUST_EMAIL       = V_CUST_EMAIL
           ,ADULT_CNT        = V_ADULT_CNT
           ,CHILD_CNT        = V_CHILD_CNT
           --,PRE_AMT          = V_PRE_AMT
           --,CONTRACT_AMT     = V_CONTRACT_AMT
           --,ACCEPT_DATE      = V_ACCEPT_DATE
           --,CONFIRM_DATE     = V_CONFIRM_DATE
           ,CANCEL_DATE      = V_CANCEL_DATE
           ,FINISH_DATE      = V_FINISH_DATE
           ,CHANGE_DATE      = TO_CHAR(SYSDATE, 'YYYYMMDD')  --V_CHANGE_DATE
           ,CHARGE_CODE      = V_CHARGE_CODE
           ,SAVE_CNT         = p_save_cnt                    --V_SAVE_CNT
           ,CONFIRM_EMP_NO   = V_CONFIRM_EMP_NO
           ,CONTRACT_EMP_NO  = V_CONTRACT_EMP_NO
           ,FACING_EMP_NO    = V_FACING_EMP_NO
           ,LEVEL_APPROVE    = V_LEVEL_APPROVE
           ,RMRK             = V_RMRK
           ,U_EMP_NO         = V_EMP_NO
           ,U_DATE           = SYSDATE
           ,U_IP             = V_IP
      WHERE (BIZ_CODE = V_BIZ_CODE)
        AND (EVENT_NO = V_EVENT_NO)
     ;

     --고객정보 조회
     SELECT *
       INTO p_rt
       FROM BBA001VE
      WHERE BIZ_CODE  = V_BIZ_CODE
        AND MEMBER_NO = V_EVENT_NO
     ;

     --비회원등록 수정 호출
     PKG_ABAAI03.PR_11(
                       V_BIZ_CODE                          --IN VARCHAR2
                      --BBA020MS
                      ,p_rt.CUST_NO                        --IN VARCHAR2
                      ,V_EVENT_NO                          --V_MEMBER_NO               --IN VARCHAR2
                      ,V_EVENT_NAME                        --V_MEMBER_NAME_KOR         --IN VARCHAR2
                      ,NULL                                --V_MEMBER_NAME_ENG         --IN VARCHAR2
                      ,NULL                                --V_MEMBER_NAME_CHT         --IN VARCHAR2
                      ,NULL                                --V_ID_NO                   --IN VARCHAR2
                      ,'3'                                 --V_SEX_CODE                --IN VARCHAR2
                      ,'KR'                                --V_NATION_CODE             --IN VARCHAR2
                      ,NULL                                --V_BIRTH_DAY               --IN VARCHAR2
                      ,'2'                                 --V_CALENDER_CODE           --IN VARCHAR2
                      ,NULL                                --V_WEDD_DAY                --IN VARCHAR2
                      ,NULL                                --V_FOUND_DAY               --IN VARCHAR2
                      ,NULL                                --V_JOB_CODE                --IN VARCHAR2
                      ,NULL                                --V_COMPANY_NAME            --IN VARCHAR2
                      ,NULL                                --V_POST_NAME               --IN VARCHAR2
                      ,NULL                                --V_OFFICE_POSITION         --IN VARCHAR2
                      ,NULL                                --V_E_MAIL                  --IN VARCHAR2
                      ,NULL                                --V_HOME_TEL                --IN VARCHAR2
                      ,NULL                                --V_HOME_FAX                --IN VARCHAR2
                      ,NULL                                --V_OFFICE_TEL              --IN VARCHAR2
                      ,NULL                                --V_OFFICE_FAX              --IN VARCHAR2
                      ,NULL                                --V_MOBILE_TEL              --IN VARCHAR2
                      ,'N'                                 --V_SMS_YN                  --IN VARCHAR2
                      ,'N'                                 --V_EMS_YN                  --IN VARCHAR2
                      ,'X'                                 --V_DM_CODE                 --IN VARCHAR2
                      ,NULL                                --V_HOME_POST               --IN VARCHAR2
                      ,NULL                                --V_HOME_ADDRESS1           --IN VARCHAR2
                      ,NULL                                --V_HOME_ADDRESS2           --IN VARCHAR2
                      ,NULL                                --V_OFFICE_POST             --IN VARCHAR2
                      ,NULL                                --V_OFFICE_ADDRESS1         --IN VARCHAR2
                      ,NULL                                --V_OFFICE_ADDRESS2         --IN VARCHAR2
                      ,'Y'                                 --V_USE_YN                  --IN VARCHAR2
                      ,NULL                                --V_RMRK                    --IN VARCHAR2
                      --BBA010MS
                      --,V_MEMBER_SEQ                      --IN VARCHAR2
                      --,V_CUST_NO                         --IN VARCHAR2
                      --,V_CAP_MEMBER_NO                   --IN VARCHAR2
                      ,'41'--V_MEMBER_GROUP_CODE           --IN VARCHAR2
                      --,C_GROUP_GUEST_TYPE --'301'--V_GUEST_TYPE                 --IN VARCHAR2
                      ,V_GUEST_TYPE              --2018-07-03
                      ,TO_CHAR(TO_DATE(SYSDATE),'YYYYMMDD')--V_ENTR_DATE               --IN VARCHAR2
                      --,V_PSWD                            --IN VARCHAR2
                      --BBA011MS T3
                      --,V_MEMBER_NO                       --IN VARCHAR2
                      --,V_MEMBER_SEQ                      --IN VARCHAR2
                      --BAA030MS T4
                      --,V_MEMBER_SEQ                      --IN VARCHAR2
                      ,V_DATE_FROM                         --V_USE_DATE_FROM           --IN VARCHAR2
                      ,V_DATE_TO                           --V_USE_DATE_TO             --IN VARCHAR2
                      ,V_EMP_NO                            --IN VARCHAR2
                      ,V_IP                                --IN VARCHAR2
                      ,V_RET                               --OUT VARCHAR2
                     );
     IF (V_RET != 'OK') THEN
       RETURN;
     END IF;

     --마감일자 존재 여부에 따라 사용여부 변경
     IF (V_FINISH_DATE IS NOT NULL) THEN
       UPDATE BBA010MS
          SET USE_YN = 'N'
        WHERE MEMBER_SEQ = p_rt.MEMBER_SEQ
       ;
     ELSE
       UPDATE BBA010MS
          SET USE_YN = 'Y'
        WHERE MEMBER_SEQ = p_rt.MEMBER_SEQ
       ;
     END IF;

     V_RET := 'OK';

     RETURN;

     EXCEPTION
     WHEN OTHERS  THEN
          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_11]';

   END PR_11;

/*============================================================================
 시스템명        :
 작 성일         : 2011.3.17
 최종 수정일     :
 작성자          : 김 병 주
----------------------------------------------------------------------------
 프로그램 내용   : 삭제
 사용 테이블     :
----------------------------------------------------------------------------
 프로그램 설명   :
============================================================================*/
  PROCEDURE PR_12(
                     V_BIZ_CODE           IN VARCHAR2
                    ,V_EVENT_NO           IN VARCHAR2
                    ,V_RET               OUT VARCHAR2
                 )
  AS

    pMEMBER_NO              VARCHAR2(10);

  BEGIN

    SELECT MEMBER_NO
      INTO pMEMBER_NO
      FROM FAA010MS
     WHERE BIZ_CODE = V_BIZ_CODE AND
           EVENT_NO = V_EVENT_NO
    ;

    -- **** 각 영업장 계약 데이터 및 이력 삭제
    -- **객실
    DELETE FAA011HS
     WHERE BIZ_CODE = V_BIZ_CODE
       AND EVENT_NO = V_EVENT_NO
    ;

    DELETE FAA011MS
     WHERE BIZ_CODE = V_BIZ_CODE
       AND EVENT_NO = V_EVENT_NO
    ;

    -- 연회장
    DELETE FAA012HS
     WHERE BIZ_CODE = V_BIZ_CODE
       AND EVENT_NO = V_EVENT_NO
    ;

    DELETE FAA012MS
     WHERE BIZ_CODE = V_BIZ_CODE
       AND EVENT_NO = V_EVENT_NO
    ;

    -- 식음, 워터파크, 기타
    DELETE FAA013HS
     WHERE BIZ_CODE  = V_BIZ_CODE
       AND EVENT_NO  = V_EVENT_NO
    ;

    DELETE FAA013MS
     WHERE BIZ_CODE  = V_BIZ_CODE
       AND EVENT_NO  = V_EVENT_NO
    ;

    -- 골프
    DELETE FAA014HS
     WHERE BIZ_CODE = V_BIZ_CODE
       AND EVENT_NO = V_EVENT_NO
    ;

    DELETE FAA014MS
     WHERE BIZ_CODE = V_BIZ_CODE
       AND EVENT_NO = V_EVENT_NO
    ;

    -- **** 이력 삭제
    DELETE FAA010HS
    WHERE BIZ_CODE = V_BIZ_CODE AND
          EVENT_NO = V_EVENT_NO
    ;

    DELETE FAA010MS
    WHERE BIZ_CODE = V_BIZ_CODE AND
          EVENT_NO = V_EVENT_NO
    ;

    --비회원등록 삭제 호출
     PKG_ABAAI03.PR_12(
                       V_BIZ_CODE                        --IN VARCHAR2
                      ,V_EVENT_NO                        --IN VARCHAR2
                      ,V_RET                             --OUT VARCHAR2
                      );
     IF (V_RET != 'OK') THEN
       RETURN;
     END IF;

     V_RET := 'OK';

     RETURN;

     EXCEPTION
     WHEN OTHERS  THEN
          V_RET := FN_Geterror(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_12]';
   END PR_12;
/*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 계약취소
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_20(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NO                IN VARCHAR2
                    ,V_RMRK                    IN VARCHAR2
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                  )
   AS
    p_key_seq      FAA010HS.KEY_SEQ%TYPE  := 0;
    p_save_cnt     FAA010MS.SAVE_CNT%TYPE := 0;
    P_CNTM NUMBER													:= 0;
    L_CHECKIN_CNT                  NUMBER := 0;
   BEGIN


    -- 투숙한 예약건이 있는지 확인
    SELECT COUNT(*)
      INTO L_CHECKIN_CNT
      FROM FAA011MS T1
     INNER JOIN
           CAA010MS T2
        ON T2.RSV_NO        = T1.RSV_NO
     INNER JOIN
     			 DZA900MS T3
        ON T2.RSV_NO        = T3.RSV_NO
     INNER JOIN
           DAA010MS T4
        ON T3.MNG_NO        = T4.MNG_NO
     WHERE T1.BIZ_CODE      = V_BIZ_CODE
       AND T1.EVENT_NO      = V_EVENT_NO
    ;


    IF L_CHECKIN_CNT > 0 THEN
       V_RET:= '재실중인 예약건이 존재합니다.'||CHR(13)||CHR(10)||'단체 취소가 불가합니다.';
       RETURN;
    END IF;


   SELECT COUNT(RSV_NO) INTO P_CNTM
           FROM FAA011MS
           WHERE EVENT_NO=V_EVENT_NO
           AND BIZ_CODE=V_BIZ_CODE
           AND (RSV_NO !='' OR RSV_NO is not null);

      IF P_CNTM > 0 THEN
        V_RET:= '예약된 객실이 존재합니다'||CHR(10)||CHR(13)||'예약취소 후 단체 취소가 가능합니다!';
       RETURN;
    END IF;



       -- 이력입력
     SELECT NVL(MAX(KEY_SEQ),0) + 1
       INTO p_key_seq
       FROM FAA010HS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     INSERT INTO FAA010HS
            (
             BIZ_CODE
            ,EVENT_NO
            ,KEY_SEQ
            ,EVENT_NAME
            ,EVENT_CODE
            ,AREA_CODE
            ,MARKET_CODE
            ,MEMBER_NO
            ,DATE_FROM
            ,DATE_TO
            ,CUST_PART_NAME
            ,CUST_EMP_NAME
            ,CUST_TEL_NO
            ,CUST_MOBILE_NO
            ,CUST_FAX_NO
            ,CUST_EMAIL
            ,ADULT_CNT
            ,CHILD_CNT
            ,PRE_AMT
            ,CONTRACT_AMT
            ,ACCEPT_DATE
            ,CONFIRM_DATE
            ,CANCEL_DATE
            ,FINISH_DATE
            ,CHANGE_DATE
            ,CHARGE_CODE
            ,SAVE_CNT
            ,CONFIRM_EMP_NO
            ,CONTRACT_EMP_NO
            ,FACING_EMP_NO
            ,LEVEL_APPROVE
            ,RMRK
            ,U_EMP_NO
            ,U_DATE
            ,U_IP
            )
     SELECT BIZ_CODE
           ,EVENT_NO
           ,p_key_seq
           ,EVENT_NAME
           ,EVENT_CODE
           ,AREA_CODE
           ,MARKET_CODE
           ,MEMBER_NO
           ,DATE_FROM
           ,DATE_TO
           ,CUST_PART_NAME
           ,CUST_EMP_NAME
           ,CUST_TEL_NO
           ,CUST_MOBILE_NO
           ,CUST_FAX_NO
           ,CUST_EMAIL
           ,ADULT_CNT
           ,CHILD_CNT
           ,PRE_AMT
           ,CONTRACT_AMT
           ,ACCEPT_DATE
           ,CONFIRM_DATE
           ,CANCEL_DATE
           ,FINISH_DATE
           ,CHANGE_DATE
           ,CHARGE_CODE
           ,SAVE_CNT
           ,CONFIRM_EMP_NO
           ,CONTRACT_EMP_NO
           ,FACING_EMP_NO
           ,LEVEL_APPROVE
           ,RMRK
           ,U_EMP_NO
           ,U_DATE
           ,U_IP
       FROM FAA010MS
      WHERE (BIZ_CODE = V_BIZ_CODE)
        AND (EVENT_NO = V_EVENT_NO)
     ;

     -- 입력할 SAVE_CNT 값
     SELECT NVL(MAX(SAVE_CNT),0)+1
       INTO p_save_cnt
       FROM FAA010MS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     -- 업데이트
     UPDATE FAA010MS
        SET CANCEL_DATE   = TO_CHAR(SYSDATE, 'YYYYMMDD')
           ,CHANGE_DATE   = TO_CHAR(SYSDATE, 'YYYYMMDD')  --V_CHANGE_DATE
           ,SAVE_CNT      = p_save_cnt                    --V_SAVE_CNT
           ,LEVEL_APPROVE = '000'
           ,RMRK          = V_RMRK
           ,U_EMP_NO      = V_EMP_NO
           ,U_DATE        = SYSDATE
           ,U_IP          = V_IP
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     --객실예약 취소하는 프로시저 콜
     PR_220(
       V_BIZ_CODE
      ,V_EVENT_NO
      ,V_EMP_NO
      ,V_IP
      ,V_RET
     );
     IF V_RET != 'OK' THEN
       RAISE_APPLICATION_ERROR(-20091, V_RET);
     END IF;

     IF V_RET = 'OK' THEN
       --영업장 예약취소하는 프로시저 콜
       PR_221(
         V_BIZ_CODE
        ,V_EVENT_NO
        ,V_IP
        ,V_RET
       );
       IF V_RET != 'OK' THEN
         RAISE_APPLICATION_ERROR(-20091, V_RET);
       END IF;
     END IF;

     V_RET := 'OK';

     EXCEPTION
       WHEN OTHERS  THEN
         V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_20]';
   END PR_20;

/*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 계약결재
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_21(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NO                IN VARCHAR2
                    ,V_CONFIRM_EMP_NO          IN VARCHAR2
                    ,V_GUEST_TYPE              IN VARCHAR2 --2018-07-03추가
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                  )
   AS
   p_key_seq      FAA010HS.KEY_SEQ%TYPE  := 0;
   p_save_cnt     FAA010MS.SAVE_CNT%TYPE := 0;
   BEGIN
   -- 이력입력
     SELECT NVL(MAX(KEY_SEQ),0) + 1
       INTO p_key_seq
       FROM FAA010HS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     INSERT INTO FAA010HS
            (
             BIZ_CODE
            ,EVENT_NO
            ,KEY_SEQ
            ,EVENT_NAME
            ,EVENT_CODE
            ,AREA_CODE
            ,MARKET_CODE
            ,MEMBER_NO
            ,DATE_FROM
            ,DATE_TO
            ,CUST_PART_NAME
            ,CUST_EMP_NAME
            ,CUST_TEL_NO
            ,CUST_MOBILE_NO
            ,CUST_FAX_NO
            ,CUST_EMAIL
            ,ADULT_CNT
            ,CHILD_CNT
            ,PRE_AMT
            ,CONTRACT_AMT
            ,ACCEPT_DATE
            ,CONFIRM_DATE
            ,CANCEL_DATE
            ,FINISH_DATE
            ,CHANGE_DATE
            ,CHARGE_CODE
            ,SAVE_CNT
            ,CONFIRM_EMP_NO
            ,CONTRACT_EMP_NO
            ,FACING_EMP_NO
            ,LEVEL_APPROVE
            ,RMRK
            ,U_EMP_NO
            ,U_DATE
            ,U_IP
            )
     SELECT BIZ_CODE
           ,EVENT_NO
           ,p_key_seq
           ,EVENT_NAME
           ,EVENT_CODE
           ,AREA_CODE
           ,MARKET_CODE
           ,MEMBER_NO
           ,DATE_FROM
           ,DATE_TO
           ,CUST_PART_NAME
           ,CUST_EMP_NAME
           ,CUST_TEL_NO
           ,CUST_MOBILE_NO
           ,CUST_FAX_NO
           ,CUST_EMAIL
           ,ADULT_CNT
           ,CHILD_CNT
           ,PRE_AMT
           ,CONTRACT_AMT
           ,ACCEPT_DATE
           ,CONFIRM_DATE
           ,CANCEL_DATE
           ,FINISH_DATE
           ,CHANGE_DATE
           ,CHARGE_CODE
           ,SAVE_CNT
           ,CONFIRM_EMP_NO
           ,CONTRACT_EMP_NO
           ,FACING_EMP_NO
           ,LEVEL_APPROVE
           ,RMRK
           ,U_EMP_NO
           ,U_DATE
           ,U_IP
       FROM FAA010MS
      WHERE (BIZ_CODE = V_BIZ_CODE)
        AND (EVENT_NO = V_EVENT_NO)
     ;

     -- 입력할 SAVE_CNT 값
     SELECT NVL(MAX(SAVE_CNT),0)+1
       INTO p_save_cnt
       FROM FAA010MS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     UPDATE FAA010MS
        SET CONFIRM_DATE   = TO_CHAR(SYSDATE, 'YYYYMMDD')
           ,CHANGE_DATE    = TO_CHAR(SYSDATE, 'YYYYMMDD')  --V_CHANGE_DATE
           ,SAVE_CNT       = p_save_cnt                    --V_SAVE_CNT
           ,CONFIRM_EMP_NO = V_CONFIRM_EMP_NO
           ,LEVEL_APPROVE  = '002'
           ,U_EMP_NO       = V_EMP_NO
           ,U_DATE         = SYSDATE
           ,U_IP           = V_IP
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     --객실 예약하는 프로시저 콜
     PR_210(
       V_BIZ_CODE
      ,V_EVENT_NO
      ,V_GUEST_TYPE --2018-07-03추가
      ,V_EMP_NO
      ,V_IP
      ,V_RET
     );
     IF V_RET != 'OK' THEN
       RAISE_APPLICATION_ERROR(-20091, V_RET);
     END IF;

     IF V_RET = 'OK' THEN
       --영업장 예약하는 프로시저 콜
       PR_211(
         V_BIZ_CODE
        ,V_EVENT_NO
        ,V_GUEST_TYPE
        ,V_EMP_NO
        ,V_IP
        ,V_RET
       );
       IF V_RET != 'OK' THEN
         RAISE_APPLICATION_ERROR(-20091, V_RET);
       END IF;
     END IF;

     V_RET := 'OK';

     EXCEPTION
       WHEN OTHERS THEN
         V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_21]';
   END PR_21;

/*============================================================================
     시스템명        :
     작 성일         : 2010.12.16
     최종 수정일     :
     작성자          : 김 병 주
    ----------------------------------------------------------------------------
     프로그램 내용   : 결재취소
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_22(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NO                IN VARCHAR2
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_IS_SKIP                 IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                  )
   AS
   p_key_seq      FAA010HS.KEY_SEQ%TYPE  := 0;
   p_save_cnt     FAA010MS.SAVE_CNT%TYPE := 0;
   P_CNTM                         NUMBER := 0;
   L_CHECKIN_CNT                  NUMBER := 0;
   BEGIN

   -- 결재 취소 전 객실 예약 사항 확인
    SELECT COUNT(RSV_NO) INTO P_CNTM
           FROM FAA011MS
           WHERE EVENT_NO=V_EVENT_NO
           AND BIZ_CODE=V_BIZ_CODE
           AND (RSV_NO !='' OR RSV_NO is not null) ;
    IF P_CNTM > 0 AND V_IS_SKIP = 'N' THEN
       V_RET:= '예약된 객실이 존재합니다'||CHR(13)||CHR(10)||'예약취소 후 결제취소가 가능합니다!';
       RETURN;
    END IF;

    -- 투숙한 예약건이 있는지 확인
    SELECT COUNT(*)
      INTO L_CHECKIN_CNT
      FROM FAA011MS T1
     INNER JOIN
           CAA010MS T2
        ON T2.RSV_NO        = T1.RSV_NO
     INNER JOIN
     			 DZA900MS T3
        ON T2.RSV_NO        = T3.RSV_NO
     INNER JOIN
           DAA010MS T4
        ON T3.MNG_NO        = T4.MNG_NO
     WHERE T1.BIZ_CODE      = V_BIZ_CODE
       AND T1.EVENT_NO      = V_EVENT_NO
    ;


    IF L_CHECKIN_CNT > 0 THEN
       V_RET:= '재실중인 예약건이 존재합니다.'||CHR(13)||CHR(10)||'개별 예약건 확인하여 수정 또는 삭제 하시기 바랍니다.';
       RETURN;
    END IF;

   -- 이력입력
     SELECT NVL(MAX(KEY_SEQ),0) + 1
       INTO p_key_seq
       FROM FAA010HS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     INSERT INTO FAA010HS
            (
             BIZ_CODE
            ,EVENT_NO
            ,KEY_SEQ
            ,EVENT_NAME
            ,EVENT_CODE
            ,AREA_CODE
            ,MARKET_CODE
            ,MEMBER_NO
            ,DATE_FROM
            ,DATE_TO
            ,CUST_PART_NAME
            ,CUST_EMP_NAME
            ,CUST_TEL_NO
            ,CUST_MOBILE_NO
            ,CUST_FAX_NO
            ,CUST_EMAIL
            ,ADULT_CNT
            ,CHILD_CNT
            ,PRE_AMT
            ,CONTRACT_AMT
            ,ACCEPT_DATE
            ,CONFIRM_DATE
            ,CANCEL_DATE
            ,FINISH_DATE
            ,CHANGE_DATE
            ,CHARGE_CODE
            ,SAVE_CNT
            ,CONFIRM_EMP_NO
            ,CONTRACT_EMP_NO
            ,FACING_EMP_NO
            ,LEVEL_APPROVE
            ,RMRK
            ,U_EMP_NO
            ,U_DATE
            ,U_IP
            )
     SELECT BIZ_CODE
           ,EVENT_NO
           ,p_key_seq
           ,EVENT_NAME
           ,EVENT_CODE
           ,AREA_CODE
           ,MARKET_CODE
           ,MEMBER_NO
           ,DATE_FROM
           ,DATE_TO
           ,CUST_PART_NAME
           ,CUST_EMP_NAME
           ,CUST_TEL_NO
           ,CUST_MOBILE_NO
           ,CUST_FAX_NO
           ,CUST_EMAIL
           ,ADULT_CNT
           ,CHILD_CNT
           ,PRE_AMT
           ,CONTRACT_AMT
           ,ACCEPT_DATE
           ,CONFIRM_DATE
           ,CANCEL_DATE
           ,FINISH_DATE
           ,CHANGE_DATE
           ,CHARGE_CODE
           ,SAVE_CNT
           ,CONFIRM_EMP_NO
           ,CONTRACT_EMP_NO
           ,FACING_EMP_NO
           ,LEVEL_APPROVE
           ,RMRK
           ,U_EMP_NO
           ,U_DATE
           ,U_IP
       FROM FAA010MS
      WHERE (BIZ_CODE = V_BIZ_CODE)
        AND (EVENT_NO = V_EVENT_NO)
     ;

     -- 입력할 SAVE_CNT 값
     SELECT NVL(MAX(SAVE_CNT),0)+1
       INTO p_save_cnt
       FROM FAA010MS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     -- 견적 상태로 업데이트
     UPDATE FAA010MS
        SET CONFIRM_DATE     = NULL
           ,CHANGE_DATE      = TO_CHAR(SYSDATE, 'YYYYMMDD')  --V_CHANGE_DATE
           ,SAVE_CNT         = p_save_cnt                    --V_SAVE_CNT
           --,CONFIRM_EMP_NO   = NULL
           ,LEVEL_APPROVE    = '001'
           ,U_EMP_NO         = V_EMP_NO
           ,U_DATE           = SYSDATE
           ,U_IP             = V_IP
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

     --객실예약 취소하는 프로시저 콜
     PR_220(
       V_BIZ_CODE
      ,V_EVENT_NO
      ,V_EMP_NO
      ,V_IP
      ,V_RET
     );
     IF V_RET != 'OK' THEN
       RAISE_APPLICATION_ERROR(-20091, V_RET);
     END IF;

     IF V_RET = 'OK' THEN
       --영업장 예약취소하는 프로시저 콜
       PR_221(
         V_BIZ_CODE
        ,V_EVENT_NO
        ,V_IP
        ,V_RET
       );
       IF V_RET != 'OK' THEN
         RAISE_APPLICATION_ERROR(-20091, V_RET);
       END IF;
     END IF;

     V_RET := 'OK';

     EXCEPTION
     WHEN OTHERS  THEN
          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_22]';
   END PR_22;

/*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실 입력
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_30(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NO                IN VARCHAR2
                    ,V_STATUS_CODE             IN VARCHAR2
                    ,V_FACILITY_CODE           IN VARCHAR2
                    ,V_ROOM_TYPE               IN VARCHAR2
                    ,V_CHECKIN_DATE            IN VARCHAR2
                    ,V_NIGHTS                  IN VARCHAR2
                    ,V_ROOM_CNT                IN VARCHAR2
                    ,V_GUEST_TYPE              IN VARCHAR2
                    ,V_UNIT_AMT                IN VARCHAR2
                    ,V_SALE_AMT_DAY            IN VARCHAR2
                    ,V_SALE_AMT_WEEKEND        IN VARCHAR2
                    ,V_SALE_AMT                IN VARCHAR2
                    ,V_RSV_NO                  IN VARCHAR2
                    ,V_RMRK                    IN VARCHAR2
                    ,V_CONFIRM                 IN VARCHAR2
                    ,V_REVISE                  IN VARCHAR2
                    -- 2018-12-19 추가
                    ,V_TPR_HARD_CNT            IN VARCHAR2
                    ,V_TPR_RGLR_CNT            IN VARCHAR2
                    ,V_TPR_SOFT_CNT            IN VARCHAR2
                    ,V_GUEST_NAME              IN VARCHAR2
                    ,V_CARD_CO_CODE            IN VARCHAR2
                    ,V_CARD_NO                 IN VARCHAR2
                    ,V_VALID_THRU              IN VARCHAR2
                    ,V_ADULT_CNT               IN VARCHAR2
                    ,V_CHILD_CNT               IN VARCHAR2
--                    ,V_INFANT_CNT              IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
                    -- 2018-02-23 추가
                    , V_FIXED_RATE_YN          IN VARCHAR2
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                    ,V_KEY_SEQ                OUT VARCHAR2
                  )
   AS
--     P_GUEST_TYPE     BBA010MS.GUEST_TYPE    %TYPE;
     P_TASK_DATE      DZA010MS.TASK_DATE     %TYPE;
     L_LEVEL_APPROVE  FAA010MS.LEVEL_APPROVE %TYPE;
   BEGIN

      SELECT TASK_DATE
       INTO P_TASK_DATE
       FROM DZA010MS
      WHERE BIZ_CODE      = V_BIZ_CODE
        AND FACILITY_CODE = V_FACILITY_CODE
      ;

      IF P_TASK_DATE > V_CHECKIN_DATE THEN
          V_RET:= '객실 영업일자 이전입니다 ';
          RETURN;
      END IF;

        --순번
     SELECT NVL(MAX(KEY_SEQ), 0) + 1
       INTO V_KEY_SEQ
       FROM FAA011MS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
     ;

--     --우대구분 조회
--     SELECT T2.GUEST_TYPE
--       INTO P_GUEST_TYPE
--       FROM FAA010MS T1
--      INNER JOIN BBA001VE T2
--         ON T1.BIZ_CODE = T2.BIZ_CODE
--        AND T1.MEMBER_NO = T2.MEMBER_NO
--        AND T2.USE_YN_B = 'Y'
--      WHERE T1.BIZ_CODE = V_BIZ_CODE
--        AND T1.EVENT_NO = V_EVENT_NO
--     ;

     INSERT INTO FAA011MS
            (
             BIZ_CODE,
             EVENT_NO,
             KEY_SEQ,
             STATUS_CODE,
             FACILITY_CODE,
             ROOM_TYPE,
             CHECKIN_DATE,
             NIGHTS,
             ROOM_CNT,
             GUEST_TYPE,
             UNIT_AMT,
             SALE_AMT_DAY,
             SALE_AMT_WEEKEND,
             SALE_AMT,
             --RSV_NO,
             RMRK,
             CONFIRM,
             REVISE
             -- 2018-12-19 추가
            ,TPR_HARD_CNT
            ,TPR_RGLR_CNT
            ,TPR_SOFT_CNT
            ,GUEST_NAME
            ,CARD_CO_CODE
            ,CARD_NO
            ,VALID_THRU
            ,ADULT_CNT
            ,CHILD_CNT
            ,INFANT_CNT
            ,PERSON_CNT
             -- 2018-02-23 추가
            , FIXED_RATE_YN
            ,U_EMP_NO,
             U_DATE,
             U_IP
            )
     VALUES
            (
             V_BIZ_CODE,
             V_EVENT_NO,
             V_KEY_SEQ,
             'Y',                 --V_STATUS_CODE,
             V_FACILITY_CODE,
             V_ROOM_TYPE,
             V_CHECKIN_DATE,
             V_NIGHTS,
             V_ROOM_CNT,
             V_GUEST_TYPE,        --P_GUEST_TYPE
             V_UNIT_AMT,
             V_SALE_AMT_DAY,
             V_SALE_AMT_WEEKEND,
             V_SALE_AMT,
             --V_RSV_NO,
             V_RMRK,
             '3',                  --V_CONFIRM,  --(1:확인, 2:거부, 3:보류)
             '001'                 --V_REVISE,   --(001:신규, 002:변경, 003:취소)
            ,V_TPR_HARD_CNT
            ,V_TPR_RGLR_CNT
            ,V_TPR_SOFT_CNT
            ,V_GUEST_NAME
            ,V_CARD_CO_CODE
            ,V_CARD_NO
            ,V_VALID_THRU
            ,V_ADULT_CNT
            ,V_CHILD_CNT
            ,0                      -- V_INFANT_CNT
            ,V_ADULT_CNT            -- V_PERSON_CNT
             -- 2018-02-23 추가
            , NVL(V_FIXED_RATE_YN, 'N')
            ,V_EMP_NO,
             SYSDATE,
             V_IP
            )
     ;

     SELECT LEVEL_APPROVE
       INTO L_LEVEL_APPROVE
       FROM FAA010MS
      WHERE BIZ_CODE      = V_BIZ_CODE
        AND EVENT_NO      = V_EVENT_NO
     ;

     IF L_LEVEL_APPROVE = '002' THEN
       --객실 예약하는 프로시저 콜
       PR_300(
         V_BIZ_CODE
        ,V_EVENT_NO
        ,V_KEY_SEQ
        ,V_GUEST_TYPE              --2018-07-03추가
        ,V_EMP_NO
        ,V_IP
        ,V_RET
       );
       IF V_RET != 'OK' THEN
         RAISE_APPLICATION_ERROR(-20091, V_RET);
       END IF;
     END IF;

     V_RET := 'OK';

     EXCEPTION
       WHEN OTHERS  THEN
         V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_30]';
   END PR_30;

/*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실 수정
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_31(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NO                IN VARCHAR2
                    ,V_KEY_SEQ                 IN VARCHAR2
                    ,V_STATUS_CODE             IN VARCHAR2
                    ,V_FACILITY_CODE           IN VARCHAR2
                    ,V_ROOM_TYPE               IN VARCHAR2
                    ,V_CHECKIN_DATE            IN VARCHAR2
                    ,V_NIGHTS                  IN VARCHAR2
                    ,V_ROOM_CNT                IN VARCHAR2
                    ,V_GUEST_TYPE              IN VARCHAR2
                    ,V_UNIT_AMT                IN VARCHAR2
                    ,V_SALE_AMT_DAY            IN VARCHAR2
                    ,V_SALE_AMT_WEEKEND        IN VARCHAR2
                    ,V_SALE_AMT                IN VARCHAR2
                    ,V_RSV_NO                  IN VARCHAR2
                    ,V_RMRK                    IN VARCHAR2
                    ,V_CONFIRM                 IN VARCHAR2
                    ,V_REVISE                  IN VARCHAR2
                    -- 2018-12-19 추가
                    ,V_TPR_HARD_CNT            IN VARCHAR2
                    ,V_TPR_RGLR_CNT            IN VARCHAR2
                    ,V_TPR_SOFT_CNT            IN VARCHAR2
                    ,V_GUEST_NAME              IN VARCHAR2
                    ,V_CARD_CO_CODE            IN VARCHAR2
                    ,V_CARD_NO                 IN VARCHAR2
                    ,V_VALID_THRU              IN VARCHAR2
                    ,V_ADULT_CNT               IN VARCHAR2
                    ,V_CHILD_CNT               IN VARCHAR2
--                    ,V_INFANT_CNT              IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
                    -- 2018-02-23 추가
                    , V_FIXED_RATE_YN          IN VARCHAR2
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                  )
   AS
     P_H_SEQ           FAA011HS.H_SEQ         %TYPE;
     P_TASK_DATE       DZA010MS.TASK_DATE     %TYPE;
     L_LEVEL_APPROVE   FAA010MS.LEVEL_APPROVE %TYPE;
     L_CHECKIN_CNT                  NUMBER := 0;

   BEGIN

      SELECT TASK_DATE
       INTO P_TASK_DATE
       FROM DZA010MS
      WHERE BIZ_CODE      = V_BIZ_CODE
        AND FACILITY_CODE = V_FACILITY_CODE
      ;

        IF P_TASK_DATE > V_CHECKIN_DATE THEN
            V_RET:= '객실 영업일자 이전입니다 ';
            RETURN;
        END IF;

      -- 투숙한 예약건이 있는지 확인
      SELECT COUNT(*)
        INTO L_CHECKIN_CNT
        FROM FAA011MS T1
       INNER JOIN
             CAA010MS T2
          ON T2.RSV_NO        = T1.RSV_NO
       INNER JOIN
             DZA900MS T3
          ON T2.RSV_NO        = T3.RSV_NO
       INNER JOIN
             DAA010MS T4
          ON T3.MNG_NO        = T4.MNG_NO
       WHERE T1.BIZ_CODE      = V_BIZ_CODE
         AND T1.EVENT_NO      = V_EVENT_NO
         AND T1.KEY_SEQ     = V_KEY_SEQ
      ;


      IF L_CHECKIN_CNT > 0 THEN
         V_RET:= '재실중인 예약건입니다.'||CHR(13)||CHR(10)||'재실중인 건은 수정/삭제가 불가합니다.';
         RETURN;
      END IF;





     SELECT NVL(MAX(H_SEQ),0) + 1
       INTO P_H_SEQ
       FROM FAA011HS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
        AND KEY_SEQ  = V_KEY_SEQ
     ;

     INSERT INTO FAA011HS
            (
             BIZ_CODE
            ,EVENT_NO
            ,KEY_SEQ
            ,H_SEQ
            ,STATUS_CODE
            ,FACILITY_CODE
            ,ROOM_TYPE
            ,CHECKIN_DATE
            ,NIGHTS
            ,ROOM_CNT
            ,GUEST_TYPE
            ,UNIT_AMT
            ,SALE_AMT_DAY
            ,SALE_AMT_WEEKEND
            ,SALE_AMT
            ,RSV_NO
            ,RMRK
            ,CONFIRM
            ,REVISE
            ,U_EMP_NO
            ,U_DATE
            ,U_IP
          , TPR_HARD_CNT
          , TPR_RGLR_CNT
          , TPR_SOFT_CNT
          , GUEST_NAME
          , CARD_CO_CODE
          , CARD_NO
          , VALID_THRU
          , ADULT_CNT
          , CHILD_CNT
          , INFANT_CNT
          , PERSON_CNT
          , FIXED_RATE_YN -- 02.23 추가
            )
     SELECT
             BIZ_CODE
            ,EVENT_NO
            ,KEY_SEQ
            ,P_H_SEQ
            ,STATUS_CODE
            ,FACILITY_CODE
            ,ROOM_TYPE
            ,CHECKIN_DATE
            ,NIGHTS
            ,ROOM_CNT
            ,GUEST_TYPE
            ,UNIT_AMT
            ,SALE_AMT_DAY
            ,SALE_AMT_WEEKEND
            ,SALE_AMT
            ,RSV_NO
            ,RMRK
            ,CONFIRM
            ,REVISE
            ,U_EMP_NO
            ,U_DATE
            ,U_IP
          , TPR_HARD_CNT
          , TPR_RGLR_CNT
          , TPR_SOFT_CNT
          , GUEST_NAME
          , CARD_CO_CODE
          , CARD_NO
          , VALID_THRU
          , ADULT_CNT
          , CHILD_CNT
          , INFANT_CNT
          , PERSON_CNT
          , FIXED_RATE_YN -- 02.23 추가
       FROM FAA011MS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
        AND KEY_SEQ  = V_KEY_SEQ
     ;

     UPDATE FAA011MS
        SET STATUS_CODE      = V_STATUS_CODE
           ,FACILITY_CODE    = V_FACILITY_CODE
           ,ROOM_TYPE        = V_ROOM_TYPE
           ,CHECKIN_DATE     = V_CHECKIN_DATE
           ,NIGHTS           = V_NIGHTS
           ,ROOM_CNT         = V_ROOM_CNT
           ,GUEST_TYPE       = V_GUEST_TYPE
           ,UNIT_AMT         = V_UNIT_AMT
           ,SALE_AMT_DAY     = V_SALE_AMT_DAY
           ,SALE_AMT_WEEKEND = V_SALE_AMT_WEEKEND
           ,SALE_AMT         = V_SALE_AMT
           --,RSV_NO           = V_RSV_NO
           ,RMRK             = V_RMRK
           --,CONFIRM          = V_CONFIRM
           ,REVISE           = '002'
          , TPR_HARD_CNT     = V_TPR_HARD_CNT
          , TPR_RGLR_CNT     = V_TPR_RGLR_CNT
          , TPR_SOFT_CNT     = V_TPR_SOFT_CNT
          , GUEST_NAME       = V_GUEST_NAME
          , CARD_CO_CODE     = V_CARD_CO_CODE
          , CARD_NO          = V_CARD_NO
          , VALID_THRU       = V_VALID_THRU
          , ADULT_CNT        = V_ADULT_CNT
          , CHILD_CNT        = V_CHILD_CNT
--          , INFANT_CNT       = V_INFANT_CNT
--          , PERSON_CNT       = V_PERSON_CNT
            -- 02.23 추가
          , FIXED_RATE_YN    = NVL(V_FIXED_RATE_YN, 'N')
           ,U_EMP_NO         = V_EMP_NO
           ,U_DATE           = SYSDATE
           ,U_IP             = V_IP
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
        AND KEY_SEQ  = V_KEY_SEQ
     ;

     SELECT LEVEL_APPROVE
       INTO L_LEVEL_APPROVE
       FROM FAA010MS
      WHERE BIZ_CODE      = V_BIZ_CODE
        AND EVENT_NO      = V_EVENT_NO
     ;

     IF L_LEVEL_APPROVE = '002' THEN
       --객실예약 수정하는 프로시저 콜
       PR_310(
         V_BIZ_CODE
        ,V_EVENT_NO
        ,V_KEY_SEQ
        ,V_EMP_NO
        ,V_IP
        ,V_RET
       );
       IF V_RET != 'OK' THEN
         RAISE_APPLICATION_ERROR(-20091, V_RET);
       END IF;
     END IF;

     V_RET := 'OK';

     EXCEPTION
       WHEN OTHERS  THEN
         V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_31]';
   END PR_31;

/*============================================================================
     시스템명        :
     작 성일         : 2009.8.11
     최종 수정일     :
     작성자          : 염 순 민
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실 삭제
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_32(
                     V_BIZ_CODE                IN VARCHAR2
                    ,V_EVENT_NO                IN VARCHAR2
                    ,V_KEY_SEQ                 IN VARCHAR2
                    ,V_EMP_NO                  IN VARCHAR2
                    ,V_IP                      IN VARCHAR2
                    ,V_RET                    OUT VARCHAR2
                  )
   AS
     L_LEVEL_APPROVE   FAA010MS.LEVEL_APPROVE %TYPE;
     L_CHECKIN_CNT                  NUMBER := 0;
   BEGIN


    -- 투숙한 예약건이 있는지 확인
    SELECT COUNT(*)
      INTO L_CHECKIN_CNT
      FROM FAA011MS T1
     INNER JOIN
           CAA010MS T2
        ON T2.RSV_NO        = T1.RSV_NO
     INNER JOIN
     			 DZA900MS T3
        ON T2.RSV_NO        = T3.RSV_NO
     INNER JOIN
           DAA010MS T4
        ON T3.MNG_NO        = T4.MNG_NO
     WHERE T1.BIZ_CODE      = V_BIZ_CODE
       AND T1.EVENT_NO      = V_EVENT_NO
       AND T1.KEY_SEQ     = V_KEY_SEQ
    ;


    IF L_CHECKIN_CNT > 0 THEN
       V_RET:= '재실중인 예약건입니다.'||CHR(13)||CHR(10)||'재실중인 건은 수정/삭제가 불가합니다.';
       RETURN;
    END IF;

     SELECT LEVEL_APPROVE
       INTO L_LEVEL_APPROVE
       FROM FAA010MS
      WHERE BIZ_CODE      = V_BIZ_CODE
        AND EVENT_NO      = V_EVENT_NO
     ;

     IF L_LEVEL_APPROVE = '002' THEN
       --객실예약 취소하는 프로시저 콜
       PR_320(
         V_BIZ_CODE
        ,V_EVENT_NO
        ,V_KEY_SEQ
        ,V_EMP_NO
        ,V_IP
        ,V_RET
       );
       IF V_RET != 'OK' THEN
         RAISE_APPLICATION_ERROR(-20091, V_RET);
       END IF;
--       IF V_RET != 'OK' THEN
--         RETURN;
--       END IF;
     END IF;

     DELETE FAA011HS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
        AND KEY_SEQ  = V_KEY_SEQ
    ;

     DELETE FAA011MS
      WHERE BIZ_CODE = V_BIZ_CODE
        AND EVENT_NO = V_EVENT_NO
        AND KEY_SEQ  = V_KEY_SEQ
     ;

     V_RET := 'OK';

     RETURN;

     EXCEPTION
     WHEN OTHERS  THEN
          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_32]';
   END PR_32;
--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 식음 입력
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_40(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                    ,V_KEY_SEQ                OUT VARCHAR2
--                  )
--   AS
--     L_LEVEL_APPROVE  FAA010MS.LEVEL_APPROVE %TYPE;
--   BEGIN
--
--     --순번
--     SELECT NVL(MAX(KEY_SEQ), 0) + 1
--       INTO V_KEY_SEQ
--       FROM FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = '001'  --V_FUNC_CODE, [공통코드:F0002] 001:식음, 002:부대업장(워터파크), 900:기타
--     ;
--
--     INSERT INTO FAA013MS
--            (
--             BIZ_CODE
--            ,EVENT_NO
--            ,FUNC_CODE
--            ,KEY_SEQ
--            ,STATUS_CODE
--            ,ST_DATE
--            ,ST_TIME
--            ,FACILITY_CODE
--            ,MENU_CODE
--            ,UNIT_AMT
--            ,SALE_AMT
--            ,PERSON_CNT
--            ,PLAN_CNT
--            ,PLAN_AMT
--            ,RMRK
--            ,CONFIRM
--            ,REVISE
--            ,U_EMP_NO
--            ,U_DATE
--            ,U_IP
--            )
--     VALUES
--            (
--             V_BIZ_CODE
--            ,V_EVENT_NO
--            ,'001'       --V_FUNC_CODE
--            ,V_KEY_SEQ
--            ,'Y'         --V_STATUS_CODE
--            ,V_ST_DATE
--            ,V_ST_TIME
--            ,V_FACILITY_CODE
--            ,V_MENU_CODE
--            ,V_UNIT_AMT
--            ,V_SALE_AMT
--            ,V_PERSON_CNT
--            ,V_PLAN_CNT
--            ,0           --V_PLAN_AMT
--            ,V_RMRK
--            ,'3'         --V_CONFIRM
--            ,'001'       --V_REVISE
--            ,V_EMP_NO
--            ,SYSDATE
--            ,V_IP
--            )
--     ;
--
--     SELECT LEVEL_APPROVE
--       INTO L_LEVEL_APPROVE
--       FROM FAA010MS
--      WHERE BIZ_CODE      = V_BIZ_CODE
--        AND EVENT_NO      = V_EVENT_NO
--     ;
--     IF L_LEVEL_APPROVE = '002' THEN
--       --영업장 예약하는 프로시저 콜
--       PR_400(
--         V_BIZ_CODE
--        ,V_EVENT_NO
--        ,'001'
--        ,V_KEY_SEQ
--        ,V_EMP_NO
--        ,V_IP
--        ,V_RET
--       );
--       IF V_RET != 'OK' THEN
--         RAISE_APPLICATION_ERROR(-20091, V_RET);
--       END IF;
--     END IF;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_40]';
--   END PR_40;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 식음 수정
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_41(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--     P_H_SEQ FAA013HS.H_SEQ%TYPE;
--     L_LEVEL_APPROVE  FAA010MS.LEVEL_APPROVE %TYPE;
--   BEGIN
--
--     SELECT NVL(MAX(H_SEQ),0) + 1
--       INTO P_H_SEQ
--       FROM FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     INSERT INTO FAA013HS
--            (
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--            )
--      SELECT
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             P_H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--        FROM FAA013MS
--       WHERE BIZ_CODE  = V_BIZ_CODE
--         AND EVENT_NO  = V_EVENT_NO
--         AND FUNC_CODE = V_FUNC_CODE
--         AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     UPDATE FAA013MS
--        SET STATUS_CODE   = V_STATUS_CODE
--           ,ST_DATE       = V_ST_DATE
--           ,ST_TIME       = V_ST_TIME
--           ,FACILITY_CODE = V_FACILITY_CODE
--           ,MENU_CODE     = V_MENU_CODE
--           ,UNIT_AMT      = V_UNIT_AMT
--           ,SALE_AMT      = V_SALE_AMT
--           ,PERSON_CNT    = V_PERSON_CNT
--           ,PLAN_CNT      = V_PLAN_CNT
--           --,PLAN_AMT      = V_PLAN_AMT
--           ,RMRK          = V_RMRK
--           --,CONFIRM       = V_CONFIRM
--           ,REVISE        = '002'
--           ,U_EMP_NO      = V_EMP_NO
--           ,U_DATE        = SYSDATE
--           ,U_IP          = V_IP
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     SELECT LEVEL_APPROVE
--       INTO L_LEVEL_APPROVE
--       FROM FAA010MS
--      WHERE BIZ_CODE      = V_BIZ_CODE
--        AND EVENT_NO      = V_EVENT_NO
--     ;
--
--     IF L_LEVEL_APPROVE = '002' THEN
--       --영업장예약 수정하는 프로시저 콜
--       PR_410(
--         V_BIZ_CODE
--        ,V_EVENT_NO
--        ,'001'
--        ,V_KEY_SEQ
--        ,V_EMP_NO
--        ,V_IP
--        ,V_RET
--       );
--       IF V_RET != 'OK' THEN
--         RAISE_APPLICATION_ERROR(-20091, V_RET);
--       END IF;
--     END IF;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_41]';
--   END PR_41;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 식음 삭제
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_42(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--     L_LEVEL_APPROVE   FAA010MS.LEVEL_APPROVE %TYPE;
--   BEGIN
--     SELECT LEVEL_APPROVE
--       INTO L_LEVEL_APPROVE
--       FROM FAA010MS
--      WHERE BIZ_CODE      = V_BIZ_CODE
--        AND EVENT_NO      = V_EVENT_NO
--     ;
--
--     IF L_LEVEL_APPROVE = '002' THEN
--       --영업장예약 취소하는 프로시저 콜
--       PR_420(
--         V_BIZ_CODE
--        ,V_EVENT_NO
--        ,'001'
--        ,V_KEY_SEQ
--        ,V_RET
--       );
--       IF V_RET != 'OK' THEN
--         RAISE_APPLICATION_ERROR(-20091, V_RET);
--       END IF;
----       IF V_RET != 'OK' THEN
----         RETURN;
----       END IF;
--     END IF;
--
--     DELETE FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     DELETE FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAEI01.PR_42]';
--   END PR_42;
--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 워터파크 입력
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_50(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_SALEUNIT                IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                    ,V_KEY_SEQ                OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     --순번
--     SELECT NVL(MAX(KEY_SEQ), 0) + 1
--       INTO V_KEY_SEQ
--       FROM FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = '002'  --V_FUNC_CODE, [공통코드:F0002] 001:식음, 002:부대업장(워터파크), 900:기타
--     ;
--
--     INSERT INTO FAA013MS
--            (
--             BIZ_CODE
--            ,EVENT_NO
--            ,FUNC_CODE
--            ,KEY_SEQ
--            ,STATUS_CODE
--            ,ST_DATE
--            ,ST_TIME
--            ,FACILITY_CODE
--            ,MENU_CODE
--            ,UNIT_AMT
--            ,SALE_AMT
--            ,PERSON_CNT
--            ,PLAN_CNT
--            ,PLAN_AMT
--            ,RMRK
--            ,CONFIRM
--            ,REVISE
--            ,SALE_RATE
--            ,U_EMP_NO
--            ,U_DATE
--            ,U_IP
--            )
--     VALUES
--            (
--             V_BIZ_CODE
--            ,V_EVENT_NO
--            ,'002'       --V_FUNC_CODE
--            ,V_KEY_SEQ
--            ,'Y'         --V_STATUS_CODE
--            ,V_ST_DATE
--            ,V_ST_TIME
--            ,V_FACILITY_CODE
--            ,V_MENU_CODE
--            ,V_UNIT_AMT
--            ,V_SALE_AMT
--            ,V_PERSON_CNT
--            ,0           --V_PLAN_CNT
--            ,0           --V_PLAN_AMT
--            ,V_RMRK
--            ,'3'         --V_CONFIRM
--            ,'001'       --V_REVISE
--            ,V_SALEUNIT  --V_REVISE
--            ,V_EMP_NO
--            ,SYSDATE
--            ,V_IP
--            )
--     ;
--
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_50]';
--   END PR_50;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 워터파크 수정
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_51(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_SALEUNIT                IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   P_H_SEQ FAA013HS.H_SEQ%TYPE;
--   BEGIN
--
--     SELECT NVL(MAX(H_SEQ),0) + 1
--       INTO P_H_SEQ
--       FROM FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     INSERT INTO FAA013HS
--            (
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--            )
--      SELECT
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             P_H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--        FROM FAA013MS
--       WHERE BIZ_CODE  = V_BIZ_CODE
--         AND EVENT_NO  = V_EVENT_NO
--         AND FUNC_CODE = V_FUNC_CODE
--         AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     UPDATE FAA013MS
--        SET STATUS_CODE   = V_STATUS_CODE
--           ,ST_DATE       = V_ST_DATE
--           ,ST_TIME       = V_ST_TIME
--           ,FACILITY_CODE = V_FACILITY_CODE
--           ,MENU_CODE     = V_MENU_CODE
--           ,UNIT_AMT      = V_UNIT_AMT
--           ,SALE_AMT      = V_SALE_AMT
--           ,PERSON_CNT    = V_PERSON_CNT
--           --,PLAN_CNT      = V_PLAN_CNT
--           --,PLAN_AMT      = V_PLAN_AMT
--           ,RMRK          = V_RMRK
--           --,CONFIRM       = V_CONFIRM
--           ,REVISE        = '002'
--           ,SALE_RATE     =V_SALEUNIT
--           ,U_EMP_NO      = V_EMP_NO
--           ,U_DATE        = SYSDATE
--           ,U_IP          = V_IP
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_51]';
--   END PR_51;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 워터파크 삭제
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_52(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     DELETE FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     DELETE FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_52]';
--   END PR_52;
--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 연회장 입력
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_60(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_END_DATE                IN VARCHAR2
--                    ,V_END_TIME                IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_RSV_STATUS              IN VARCHAR2
--                    ,V_TABLE_SET               IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                    ,V_KEY_SEQ                OUT VARCHAR2
--                  )
--
--   AS
--   P_CNTM NUMBER:=0;
--   P_CNTD NUMBER:=0;
--   BEGIN
--
--
--      SELECT COUNT(FACILITY_CODE) INTO P_CNTM  FROM FAA012MS WHERE BIZ_CODE=V_BIZ_CODE
--                                        AND MENU_CODE=V_MENU_CODE
--                                        AND FACILITY_CODE=V_FACILITY_CODE
--                                        AND ST_DATE=V_ST_DATE
--                                        AND (ST_TIME<=V_ST_DATE AND END_TIME>=V_END_TIME)
--                                        AND KEY_SEQ=V_KEY_SEQ;
--
--    IF P_CNTM > 0 THEN
--        V_RET:= '이미 연회장 확정 등록이 되어 있습니다 ';
--        RETURN;
--    END IF;
--
--   SELECT COUNT(FACILITY_CODE) INTO P_CNTD  FROM FAA022MS WHERE BIZ_CODE=V_BIZ_CODE
--                                        AND MENU_CODE=V_MENU_CODE
--                                        AND FACILITY_CODE=V_FACILITY_CODE
--                                        AND USE_DATE=V_ST_DATE
--                                         AND (ST_TIME<=V_ST_TIME AND END_TIME>=V_END_TIME)
--                                        AND KEY_SEQ=V_KEY_SEQ;
--
--    IF P_CNTD > 0 THEN
--        V_RET:= '이미 연회장 블럭 등록이 되어 있습니다 ';
--        RETURN;
--    END IF;
--
--     --순번
--     SELECT NVL(MAX(KEY_SEQ), 0) + 1
--       INTO V_KEY_SEQ
--       FROM FAA012MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--     ;
--
--     INSERT INTO FAA012MS
--           (
--            BIZ_CODE
--           ,EVENT_NO
--           ,KEY_SEQ
--           ,STATUS_CODE
--           ,ST_DATE
--           ,ST_TIME
--           ,END_DATE
--           ,END_TIME
--           ,MENU_CODE
--           ,FACILITY_CODE
--           ,PERSON_CNT
--           ,UNIT_AMT
--           ,SALE_AMT
--           ,RSV_STATUS
--           ,TABLE_SET
--           ,RMRK
--           ,CONFIRM
--           ,REVISE
--           ,U_EMP_NO
--           ,U_DATE
--           ,U_IP
--           )
--     VALUES
--           (
--            V_BIZ_CODE
--           ,V_EVENT_NO
--           ,V_KEY_SEQ
--           ,'Y'         --V_STATUS_CODE
--           ,V_ST_DATE
--           ,V_ST_TIME
--           ,V_END_DATE
--           ,V_END_TIME
--           ,V_MENU_CODE
--           ,V_FACILITY_CODE
--           ,V_PERSON_CNT
--           ,V_UNIT_AMT
--           ,V_SALE_AMT
--           ,'Y'        --V_RSV_STATUS
--           ,V_TABLE_SET
--           ,V_RMRK
--           ,'3'        --V_CONFIRM
--           ,'001'      --V_REVISE
--           ,V_EMP_NO
--           ,SYSDATE
--           ,V_IP
--           ) ;
--
--
--     V_RET := 'OK';
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_60]';
--   END PR_60;
--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 연회장 수정
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_61(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_END_DATE                IN VARCHAR2
--                    ,V_END_TIME                IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_RSV_STATUS              IN VARCHAR2
--                    ,V_TABLE_SET               IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--    P_H_SEQ FAA012HS.H_SEQ%TYPE;
--   P_CNTM NUMBER:=0;
--   P_CNTD NUMBER:=0;
--   BEGIN
--
--      SELECT COUNT(FACILITY_CODE) INTO P_CNTM  FROM FAA012MS WHERE BIZ_CODE=V_BIZ_CODE
--                                        AND MENU_CODE=V_MENU_CODE
--                                        AND FACILITY_CODE=V_FACILITY_CODE
--                                        AND ST_DATE=V_ST_DATE
--                                        AND (ST_TIME>=V_ST_TIME AND END_TIME<=V_END_TIME)
--                                        AND KEY_SEQ=V_KEY_SEQ;
--
--   -- IF P_CNTM > 0 THEN
--   --     V_RET:= '이미 연회장 확정 등록이 되어 있습니다 ';
--   --     RETURN;
--   -- END IF;
--
--   SELECT COUNT(FACILITY_CODE) INTO P_CNTD  FROM FAA022MS WHERE BIZ_CODE=V_BIZ_CODE
--                                        AND MENU_CODE=V_MENU_CODE
--                                        AND FACILITY_CODE=V_FACILITY_CODE
--                                        AND USE_DATE=V_ST_DATE
--                                        AND (ST_TIME>=V_ST_TIME AND END_TIME<=V_ST_TIME)
--                                        AND KEY_SEQ=V_KEY_SEQ;
--
--   -- IF P_CNTD > 0 THEN
--   --     V_RET:= '이미 연회장 블럭 등록이 되어 있습니다 ';
--   --     RETURN;
--   -- END IF;
--
--
--     SELECT NVL(MAX(H_SEQ),0) + 1
--       INTO P_H_SEQ
--       FROM FAA012HS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     INSERT INTO FAA012HS
--            (
--             BIZ_CODE,
--             EVENT_NO,
--             KEY_SEQ,
--             H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             END_DATE,
--             END_TIME,
--             MENU_CODE,
--             FACILITY_CODE,
--             PERSON_CNT,
--             UNIT_AMT,
--             SALE_AMT,
--             RSV_STATUS,
--             TABLE_SET,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--            )
--      SELECT
--             BIZ_CODE,
--             EVENT_NO,
--             KEY_SEQ,
--             P_H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             END_DATE,
--             END_TIME,
--             MENU_CODE,
--             FACILITY_CODE,
--             PERSON_CNT,
--             UNIT_AMT,
--             SALE_AMT,
--             RSV_STATUS,
--             TABLE_SET,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--        FROM FAA012MS
--       WHERE BIZ_CODE = V_BIZ_CODE
--         AND EVENT_NO = V_EVENT_NO
--         AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     UPDATE FAA012MS
--        SET  STATUS_CODE   = V_STATUS_CODE
--            ,ST_DATE       = V_ST_DATE
--            ,ST_TIME       = V_ST_TIME
--            ,END_DATE      = V_END_DATE
--            ,END_TIME      = V_END_TIME
--            ,MENU_CODE     = V_MENU_CODE
--            ,FACILITY_CODE = V_FACILITY_CODE
--            ,PERSON_CNT    = V_PERSON_CNT
--            ,UNIT_AMT      = V_UNIT_AMT
--            ,SALE_AMT      = V_SALE_AMT
--            --,RSV_STATUS    = V_RSV_STATUS
--            ,TABLE_SET     = V_TABLE_SET
--            ,RMRK          = V_RMRK
--            --,CONFIRM       = V_CONFIRM
--            ,REVISE        = '002'
--            ,U_EMP_NO      = V_EMP_NO
--            ,U_DATE        = SYSDATE
--            ,U_IP          = V_IP
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND KEY_SEQ   = V_KEY_SEQ ;
--
--
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_61]';
--   END PR_61;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 연회장 삭제
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_62(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     DELETE FAA012HS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     DELETE FAA012MS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_62]';
--   END PR_62;
--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 기타 입력
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_70(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                    ,V_KEY_SEQ                OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     --순번
--     SELECT NVL(MAX(KEY_SEQ), 0) + 1
--       INTO V_KEY_SEQ
--       FROM FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = '900'  --V_FUNC_CODE, [공통코드:F0002] 001:식음, 002:부대업장(워터파크), 900:기타
--     ;
--
--     INSERT INTO FAA013MS
--            (
--             BIZ_CODE
--            ,EVENT_NO
--            ,FUNC_CODE
--            ,KEY_SEQ
--            ,STATUS_CODE
--            ,ST_DATE
--            ,ST_TIME
--            ,FACILITY_CODE
--            ,MENU_CODE
--            ,UNIT_AMT
--            ,SALE_AMT
--            ,PERSON_CNT
--            ,PLAN_CNT
--            ,PLAN_AMT
--            ,RMRK
--            ,CONFIRM
--            ,REVISE
--            ,U_EMP_NO
--            ,U_DATE
--            ,U_IP
--            )
--     VALUES
--            (
--             V_BIZ_CODE
--            ,V_EVENT_NO
--            ,'900'       --V_FUNC_CODE
--            ,V_KEY_SEQ
--            ,'Y'         --V_STATUS_CODE
--            ,V_ST_DATE
--            ,V_ST_TIME
--            ,V_FACILITY_CODE
--            ,V_MENU_CODE
--            ,V_UNIT_AMT
--            ,V_SALE_AMT
--            ,V_PERSON_CNT
--            ,0           --V_PLAN_CNT
--            ,0           --V_PLAN_AMT
--            ,V_RMRK
--            ,'3'         --V_CONFIRM
--            ,'001'       --V_REVISE
--            ,V_EMP_NO
--            ,SYSDATE
--            ,V_IP
--            )
--     ;
--
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_70]';
--   END PR_70;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 기타 수정
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_71(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   P_H_SEQ FAA013HS.H_SEQ%TYPE;
--   BEGIN
--
--     SELECT NVL(MAX(H_SEQ),0) + 1
--       INTO P_H_SEQ
--       FROM FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     INSERT INTO FAA013HS
--            (
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--            )
--      SELECT
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             P_H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--        FROM FAA013MS
--       WHERE BIZ_CODE  = V_BIZ_CODE
--         AND EVENT_NO  = V_EVENT_NO
--         AND FUNC_CODE = V_FUNC_CODE
--         AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     UPDATE FAA013MS
--        SET STATUS_CODE   = V_STATUS_CODE
--           ,ST_DATE       = V_ST_DATE
--           ,ST_TIME       = V_ST_TIME
--           ,FACILITY_CODE = V_FACILITY_CODE
--           ,MENU_CODE     = V_MENU_CODE
--           ,UNIT_AMT      = V_UNIT_AMT
--           ,SALE_AMT      = V_SALE_AMT
--           ,PERSON_CNT    = V_PERSON_CNT
--           --,PLAN_CNT      = V_PLAN_CNT
--           --,PLAN_AMT      = V_PLAN_AMT
--           ,RMRK          = V_RMRK
--           --,CONFIRM       = V_CONFIRM
--           ,REVISE        = '002'
--           ,U_EMP_NO      = V_EMP_NO
--           ,U_DATE        = SYSDATE
--           ,U_IP          = V_IP
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_71]';
--   END PR_71;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2009.8.11
--     최종 수정일     :
--     작성자          : 염 순 민
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 기타 삭제
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_72(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     DELETE FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     DELETE FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_72]';
--   END PR_72;
   /*============================================================================
     시스템명        : 객실 정상단가 가져오기
     작 성일         :2010-05-13
     최종 수정일     :
     작성자          : 신태운
    ----------------------------------------------------------------------------
     프로그램 내용   :
     사용 테이블     :  PR_80 =  조회


    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
   PROCEDURE PR_80(
                     V_BIZ_CODE                      IN VARCHAR2
                    ,V_ROOM_TYPE                     IN VARCHAR2
                    ,V_CHECKIN_FROM                  IN VARCHAR2
                    ,V_CHECKIN_TO                    IN VARCHAR2
                    ,V_GUEST_TYPE                    IN VARCHAR2
                    ,V_RS01                          OUT RS
                    ,V_RS02                          OUT RS
                    ,V_RS03                          OUT RS
                  )
    AS
    BEGIN
        OPEN V_RS01 FOR

    SELECT
        UNIT_AMT
    FROM    JBA013MS A, CXA010MS B--, DZA080MS D
          WHERE   A.BIZ_CODE      = V_BIZ_CODE
          AND     A.FACILITY_CODE = '1001'
          AND     A.MENU_CODE     = 'D1001'
          AND     A.FACILITY_CODE = B.FACILITY_CODE
          AND     A.MENU_ITEM1    = B.SEASON_CODE
          AND     A.MENU_ITEM2    = V_GUEST_TYPE --C_GROUP_GUEST_TYPE --'301'
          AND     A.MENU_ITEM3    = V_ROOM_TYPE
          AND     A.MENU_ITEM4    = '1'
          AND     B.CALN_DATE     BETWEEN A.DATE_FROM AND A.DATE_TO
          AND     B.BIZ_CODE      = A.BIZ_CODE
          AND     B.FACILITY_CODE = A.FACILITY_CODE
          AND     B.CALN_DATE    BETWEEN V_CHECKIN_FROM AND TO_CHAR(TO_DATE(V_CHECKIN_TO,'YYYYMMDD')-1, 'YYYYMMDD');

        OPEN V_RS02 FOR
          SELECT count(*) AS WEEKDAYCNT  FROM CXA010MS WHERE BIZ_CODE=V_BIZ_CODE
            AND CALN_DATE BETWEEN V_CHECKIN_FROM AND TO_CHAR(TO_DATE(V_CHECKIN_TO,'YYYYMMDD')-1,'YYYYMMDD')
            AND WEEK_CODE='1';

        OPEN V_RS03 FOR
       SELECT count(*) AS WEEKENDCNT  FROM CXA010MS WHERE BIZ_CODE=V_BIZ_CODE
            AND CALN_DATE BETWEEN V_CHECKIN_FROM AND  TO_CHAR(TO_DATE(V_CHECKIN_TO,'YYYYMMDD')-1,'YYYYMMDD')
            AND WEEK_CODE <>'1';



     END PR_80;
--        /*============================================================================
--     시스템명        : 식음 정상단가 가져오기
--     작 성일         :2010-05-13
--     최종 수정일     :
--     작성자          : 신태운
--    ----------------------------------------------------------------------------
--     프로그램 내용   :
--     사용 테이블     :  PR_81 =  조회
--
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--   PROCEDURE PR_81(
--                     V_BIZ_CODE                      IN VARCHAR2
--                    ,V_ST_DATE                       IN VARCHAR2
--                    ,V_FACILTIY_CODE                 IN VARCHAR2
--                    ,V_MENU_CODE                     IN VARCHAR2
--                    ,V_RS01                          OUT RS
--                  )
--    AS
--    BEGIN
--        OPEN V_RS01 FOR
--
--
-- SELECT UNIT_AMT
--   FROM JBA010VE  A
--  WHERE BIZ_CODE=V_BIZ_CODE
--    AND FACILITY_CODE=V_FACILTIY_CODE
--    AND MENU_CODE=V_MENU_CODE
--    AND V_ST_DATE BETWEEN DATE_FROM AND DATE_TO
--    AND EXISTS
--        (SELECT *
--           FROM
--        (SELECT A.BIZ_CODE
--               ,B.FACILITY_CODE
--               ,DECODE(B.POS_CODE_600, 'Y', A.SEASON_CODE, '1') AS SEASON_CODE
--               ,DECODE(B.POS_CODE_601, 'Y', A.WEEK_CODE  , '1') AS WEEK_CODE
--           FROM ZXA020MS A,
--                (SELECT BIZ_CODE
--                       ,FACILITY_CODE
--                       ,MAX(DECODE(POS_CODE, '600', USE_YN)) AS POS_CODE_600 -- 시즌적용여부
--                       ,MAX(DECODE(POS_CODE, '601', USE_YN)) AS POS_CODE_601 -- 휴일적용여부
--                   FROM JAA020DT
--                  WHERE BIZ_CODE      = V_BIZ_CODE -- :P0
--                    AND FACILITY_CODE = V_FACILTIY_CODE --:P1
--                  GROUP BY BIZ_CODE, FACILITY_CODE) B
--          WHERE A.BIZ_CODE   = B.BIZ_CODE
--           AND A.CALN_DATE   = TO_CHAR(SYSDATE, 'YYYYMMDD')
--         ORDER BY A.CALN_DATE) B
--        WHERE A.BIZ_CODE = B.BIZ_CODE
--          AND A.FACILITY_CODE = B.FACILITY_CODE
--          AND A.MENU_ITEM1    = B.SEASON_CODE
--          AND A.MENU_ITEM2    = B.WEEK_CODE);
--
--
--    END PR_81;

--      /*============================================================================
--     시스템명        : 워터파크 정상단가 가져오기
--     작 성일         :2010-05-13
--     최종 수정일     :
--     작성자          : 신태운
--    ----------------------------------------------------------------------------
--     프로그램 내용   :
--     사용 테이블     :  PR_82 =  조회
--
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--   PROCEDURE PR_82(
--                    V_BIZ_CODE                      IN VARCHAR2
--                    ,V_ST_DATE                       IN VARCHAR2
--                    ,V_FACILTIY_CODE                 IN VARCHAR2
--                    ,V_MENU_CODE                     IN VARCHAR2
--                    ,V_RS01                          OUT RS
--                   )
--    AS
--    BEGIN
--         OPEN V_RS01 FOR
--        SELECT
--           A.UNIT_AMT - NVL(D.FNB_SALE_AMT, 0)  AS UNIT_AMT
--        FROM    JBA014MS A, Zxa020MS B, DZA080MS D
--        WHERE   A.BIZ_CODE      = V_BIZ_CODE
--            AND     A.FACILITY_CODE = V_FACILTIY_CODE
--            AND     A.MENU_CODE     = V_MENU_CODE
--             AND     A.MENU_ITEM1    = B.SEASON_CODE
--            AND     A.MENU_ITEM2    = '1'
--               AND     B.CALN_DATE     BETWEEN A.DATE_FROM AND A.DATE_TO
--            AND     B.BIZ_CODE      = A.BIZ_CODE
--            AND     b.CALN_DATE=V_ST_DATE
--            AND     A.BIZ_CODE      = D.BIZ_CODE(+)
--            AND     A.FACILITY_CODE = D.FACILITY_CODE(+)
--            AND     A.MENU_ITEM1    = D.SEASON_CODE(+)
--            AND     A.MENU_ITEM2    = D.GUEST_TYPE(+)
--            AND     D.USE_YN(+)     = 'Y';
--
--    END PR_82;

--     /*============================================================================
--     시스템명        : 연회장 정상단가 가져오기
--     작 성일         :2010-05-13
--     최종 수정일     :
--     작성자          : 신태운
--    ----------------------------------------------------------------------------
--     프로그램 내용   :
--     사용 테이블     :  PR_83 =  조회
--
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--   PROCEDURE PR_83(
--                    V_BIZ_CODE                      IN VARCHAR2
--                    ,V_ST_DATE                       IN VARCHAR2
--                    ,V_FACILTIY_CODE                 IN VARCHAR2
--                    ,V_MENU_CODE                     IN VARCHAR2
--                    ,V_RS01                          OUT RS
--                    )
--    AS
--    BEGIN
--         OPEN V_RS01 FOR
-- SELECT UNIT_AMT
--   FROM JBA010VE  A
--  WHERE BIZ_CODE=V_BIZ_CODE
--    AND FACILITY_CODE=V_FACILTIY_CODE
--    AND MENU_CODE=V_MENU_CODE
--    AND V_ST_DATE BETWEEN DATE_FROM AND DATE_TO
--    AND EXISTS
--        (SELECT *
--           FROM
--        (SELECT A.BIZ_CODE
--               ,B.FACILITY_CODE
--               ,DECODE(B.POS_CODE_600, 'Y', A.SEASON_CODE, '1') AS SEASON_CODE
--               ,DECODE(B.POS_CODE_601, 'Y', A.WEEK_CODE  , '1') AS WEEK_CODE
--           FROM ZXA020MS A,
--                (SELECT BIZ_CODE
--                       ,FACILITY_CODE
--                       ,MAX(DECODE(POS_CODE, '600', USE_YN)) AS POS_CODE_600 -- 시즌적용여부
--                       ,MAX(DECODE(POS_CODE, '601', USE_YN)) AS POS_CODE_601 -- 휴일적용여부
--                   FROM JAA020DT
--                  WHERE BIZ_CODE      = V_BIZ_CODE -- :P0
--                    AND FACILITY_CODE = V_FACILTIY_CODE --:P1
--                  GROUP BY BIZ_CODE, FACILITY_CODE) B
--          WHERE A.BIZ_CODE   = B.BIZ_CODE
--           AND A.CALN_DATE   = TO_CHAR(SYSDATE, 'YYYYMMDD')
--         ORDER BY A.CALN_DATE) B
--        WHERE A.BIZ_CODE = B.BIZ_CODE
--          AND A.FACILITY_CODE = B.FACILITY_CODE
--          AND A.MENU_ITEM1    = B.SEASON_CODE
--          AND A.MENU_ITEM2    = B.WEEK_CODE);
--
--    END PR_83;

--    /*============================================================================
--     시스템명        : 기타 정상단가 가져오기
--     작 성일         : 2010-05-13
--     최종 수정일     :
--     작성자          : 신태운
--    ----------------------------------------------------------------------------
--     프로그램 내용   :
--     사용 테이블     :  PR_84 =  조회
--
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--   PROCEDURE PR_84(
--                    V_BIZ_CODE                      IN VARCHAR2
--                    ,V_ST_DATE                       IN VARCHAR2
--                    ,V_FACILTIY_CODE                 IN VARCHAR2
--                    ,V_MENU_CODE                     IN VARCHAR2
--                    ,V_RS01                          OUT RS
--                    )
--    AS
--    BEGIN
--         OPEN V_RS01 FOR
-- SELECT UNIT_AMT
--   FROM JBA010VE  A
--  WHERE BIZ_CODE=V_BIZ_CODE
--    AND FACILITY_CODE=V_FACILTIY_CODE
--    AND MENU_CODE=V_MENU_CODE
--    AND V_ST_DATE BETWEEN DATE_FROM AND DATE_TO
--    AND EXISTS
--        (SELECT *
--           FROM
--        (SELECT A.BIZ_CODE
--               ,B.FACILITY_CODE
--               ,DECODE(B.POS_CODE_600, 'Y', A.SEASON_CODE, '1') AS SEASON_CODE
--               ,DECODE(B.POS_CODE_601, 'Y', A.WEEK_CODE  , '1') AS WEEK_CODE
--           FROM ZXA020MS A,
--                (SELECT BIZ_CODE
--                       ,FACILITY_CODE
--                       ,MAX(DECODE(POS_CODE, '600', USE_YN)) AS POS_CODE_600 -- 시즌적용여부
--                       ,MAX(DECODE(POS_CODE, '601', USE_YN)) AS POS_CODE_601 -- 휴일적용여부
--                   FROM JAA020DT
--                  WHERE BIZ_CODE      = V_BIZ_CODE -- :P0
--                    AND FACILITY_CODE = V_FACILTIY_CODE --:P1
--                  GROUP BY BIZ_CODE, FACILITY_CODE) B
--          WHERE A.BIZ_CODE   = B.BIZ_CODE
--           AND A.CALN_DATE   = TO_CHAR(SYSDATE, 'YYYYMMDD')
--         ORDER BY A.CALN_DATE) B
--        WHERE A.BIZ_CODE = B.BIZ_CODE
--          AND A.FACILITY_CODE = B.FACILITY_CODE
--          AND A.MENU_ITEM1    = B.SEASON_CODE
--          AND A.MENU_ITEM2    = B.WEEK_CODE);
--
--    END PR_84;



    /*============================================================================
     시스템명        : 결제 권한
     작 성일         : 2010-12-21
     최종 수정일     :
     작성자          : 이윤하
    ----------------------------------------------------------------------------
     프로그램 내용   :
     사용 테이블     :  PR_90 =  조회


    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
   PROCEDURE PR_90(
                     V_BIZ_CODE                      IN VARCHAR2
                    ,V_SALE_EMP_NO                   IN VARCHAR2
                    ,V_RS01                          OUT RS
                    )
    AS
    BEGIN

         OPEN V_RS01 FOR

             SELECT T1.LOGIN_ID
                   ,(SELECT ITEM1
                       FROM ZXA010MS
                      WHERE BIZ_CODE = T1.BIZ_CODE
                        AND HEAD = 'F0012'
                        AND DETAIL = T1.LEVEL_CODE) AS LEVEL_YN
              FROM ADA010MS T1, ZXA010MS T2
             WHERE T1.BIZ_CODE       = T2.BIZ_CODE
               AND T1.SALE_DEPT_CODE = T2.DETAIL
               AND T1.BIZ_CODE       = V_BIZ_CODE
               AND T1.SALE_EMP_NO    = V_SALE_EMP_NO
               AND T2.HEAD           = 'A0026'  ;
    END PR_90;

--    /*============================================================================
--     시스템명        :
--     작 성일         : 2011.1.24
--     최종 수정일     :
--     작성자          : 김 병 주
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 골프 입력
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_100(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_TEEUP_TIME_NO           IN VARCHAR2
--                    ,V_LINK_TEEUP_TIME_NO      IN VARCHAR2
--                    ,V_GUEST_TYPE              IN VARCHAR2
--                    ,V_HOLE_CODE               IN VARCHAR2
--                    ,V_ENTN_UNIT_AMT           IN NUMBER
--                    ,V_RSV_CNT                 IN NUMBER
--                    ,V_ENTN_DC_RATE            IN NUMBER
--                    ,V_ENTN_SALE_AMT           IN NUMBER
--                    ,V_CART_UNIT_CNT           IN NUMBER
--                    ,V_RSV_CART_CNT            IN NUMBER
--                    ,V_CART_DC_RATE            IN NUMBER
--                    ,V_CART_SALE_AMT           IN VARCHAR2
--                    ,V_RSV_NO                  IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                    ,V_KEY_SEQ                OUT VARCHAR2
--                  )
--   AS
--
--   BEGIN
--
--     --순번
--     SELECT NVL(MAX(KEY_SEQ), 0) + 1
--       INTO V_KEY_SEQ
--       FROM FAA014MS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--     ;
--
--     INSERT INTO FAA014MS
--            (
--                BIZ_CODE,
--                EVENT_NO,
--                KEY_SEQ,
--                STATUS_CODE,
--                TEEUP_TIME_NO,
--                LINK_TEEUP_TIME_NO,
--                GUEST_TYPE,
--                HOLE_CODE,
--                ENTN_UNIT_AMT,
--                RSV_CNT,
--                ENTN_DC_RATE,
--                ENTN_SALE_AMT,
--                CART_UNIT_AMT,
--                RSV_CART_CNT,
--                CART_DC_RATE,
--                CART_SALE_AMT,
--                RSV_NO,
--                RMRK,
--                CONFIRM,
--                REVISE,
--                U_EMP_NO,
--                U_DATE,
--                U_IP
--            )
--     VALUES
--            (
--             V_BIZ_CODE,
--             V_EVENT_NO,
--             V_KEY_SEQ,
--             'Y',                 --V_STATUS_CODE,
--             V_TEEUP_TIME_NO,
--             V_LINK_TEEUP_TIME_NO,
--             V_GUEST_TYPE,
--             V_HOLE_CODE,
--             V_ENTN_UNIT_AMT,
--             V_RSV_CNT,
--             V_ENTN_DC_RATE,
--             V_ENTN_SALE_AMT,
--             V_CART_UNIT_CNT,
--             V_RSV_CART_CNT,
--             V_CART_DC_RATE,
--             V_CART_SALE_AMT,
--             V_RSV_NO,
--             V_RMRK,
--             '3',                  --V_CONFIRM,  --(1:확인, 2:거부, 3:보류)
--             '001',                --V_REVISE,   --(001:신규, 002:변경, 003:취소)
--             V_EMP_NO,
--             SYSDATE,
--             V_IP
--            )
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_100]';
--   END PR_100;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2011.1.24
--     최종 수정일     :
--     작성자          : 김 병 주
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 골프  수정
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_101(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_KEY_SEQ                 IN NUMBER
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_TEEUP_TIME_NO           IN VARCHAR2
--                    ,V_LINK_TEEUP_TIME_NO      IN VARCHAR2
--                    ,V_GUEST_TYPE              IN VARCHAR2
--                    ,V_HOLE_CODE               IN VARCHAR2
--                    ,V_ENTN_UNIT_AMT           IN NUMBER
--                    ,V_RSV_CNT                 IN NUMBER
--                    ,V_ENTN_DC_RATE            IN NUMBER
--                    ,V_ENTN_SALE_AMT           IN NUMBER
--                    ,V_CART_UNIT_AMT           IN NUMBER
--                    ,V_RSV_CART_CNT            IN NUMBER
--                    ,V_CART_DC_RATE            IN NUMBER
--                    ,V_CART_SALE_AMT           IN VARCHAR2
--                    ,V_RSV_NO                  IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   P_H_SEQ FAA014HS.H_SEQ%TYPE;
--
--   BEGIN
--
--     SELECT NVL(MAX(H_SEQ),0) + 1
--       INTO P_H_SEQ
--       FROM FAA014HS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     INSERT INTO FAA014HS
--            (
--             BIZ_CODE
--            ,EVENT_NO
--            ,KEY_SEQ
--            ,H_SEQ
--            ,STATUS_CODE
--            ,TEEUP_TIME_NO
--            ,LINK_TEEUP_TIME_NO
--            ,GUEST_TYPE
--            ,HOLE_CODE
--            ,ENTN_UNIT_AMT
--            ,RSV_CNT
--            ,ENTN_DC_RATE
--            ,ENTN_SALE_AMT
--            ,CART_UNIT_AMT
--            ,RSV_CART_CNT
--            ,CART_DC_RATE
--            ,CART_SALE_AMT
--            ,RSV_NO
--            ,RMRK
--            ,CONFIRM
--            ,REVISE
--            ,U_EMP_NO
--            ,U_DATE
--            ,U_IP
--            )
--     SELECT
--             BIZ_CODE
--            ,EVENT_NO
--            ,KEY_SEQ
--            ,P_H_SEQ
--            ,STATUS_CODE
--            ,TEEUP_TIME_NO
--            ,LINK_TEEUP_TIME_NO
--            ,GUEST_TYPE
--            ,HOLE_CODE
--            ,ENTN_UNIT_AMT
--            ,RSV_CNT
--            ,ENTN_DC_RATE
--            ,ENTN_SALE_AMT
--            ,CART_UNIT_AMT
--            ,RSV_CART_CNT
--            ,CART_DC_RATE
--            ,CART_SALE_AMT
--            ,RSV_NO
--            ,RMRK
--            ,CONFIRM
--            ,REVISE
--            ,U_EMP_NO
--            ,U_DATE
--            ,U_IP
--       FROM FAA014MS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     UPDATE FAA014MS
--        SET  STATUS_CODE        = V_STATUS_CODE
--            ,TEEUP_TIME_NO      = V_TEEUP_TIME_NO
--            ,LINK_TEEUP_TIME_NO = V_LINK_TEEUP_TIME_NO
--            ,GUEST_TYPE         = V_GUEST_TYPE
--            ,HOLE_CODE          = V_HOLE_CODE
--            ,ENTN_UNIT_AMT      = V_ENTN_UNIT_AMT
--            ,RSV_CNT            = V_RSV_CNT
--            ,ENTN_DC_RATE       = V_ENTN_DC_RATE
--            ,ENTN_SALE_AMT      = V_ENTN_SALE_AMT
--            ,CART_UNIT_AMT      = V_CART_UNIT_AMT
--            ,RSV_CART_CNT       = V_RSV_CART_CNT
--            ,CART_DC_RATE       = V_CART_DC_RATE
--            ,CART_SALE_AMT      = V_CART_SALE_AMT
--            ,RSV_NO             = V_RSV_NO
--            ,RMRK               = V_RMRK
--            -- ,CONFIRM         = CONFIRM
--            ,REVISE             = '002'
--            ,U_EMP_NO           = V_EMP_NO
--            ,U_DATE             = SYSDATE
--            ,U_IP               = V_IP
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_101]';
--   END PR_101;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2011.1.24
--     최종 수정일     :
--     작성자          : 김 병 주
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 골프 삭제
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_102(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     DELETE FAA014HS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ = V_KEY_SEQ
--    ;
--
--     DELETE FAA014MS
--      WHERE BIZ_CODE = V_BIZ_CODE
--        AND EVENT_NO = V_EVENT_NO
--        AND KEY_SEQ  = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_102]';
--   END PR_102;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2014.12.16
--     최종 수정일     :
--     작성자          : 정 수 환
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 부대시설 입력
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_110(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                    ,V_KEY_SEQ                OUT VARCHAR2
--                  )
--   AS
--     L_LEVEL_APPROVE  FAA010MS.LEVEL_APPROVE %TYPE;
--   BEGIN
--
--     --순번
--     SELECT NVL(MAX(KEY_SEQ), 0) + 1
--       INTO V_KEY_SEQ
--       FROM FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = '003'  --V_FUNC_CODE, [공통코드:F0002] 001:식음, 002:부대업장(워터파크), 900:기타
--     ;
--
--     INSERT INTO FAA013MS
--            (
--             BIZ_CODE
--            ,EVENT_NO
--            ,FUNC_CODE
--            ,KEY_SEQ
--            ,STATUS_CODE
--            ,ST_DATE
--            ,ST_TIME
--            ,FACILITY_CODE
--            ,MENU_CODE
--            ,UNIT_AMT
--            ,SALE_AMT
--            ,PERSON_CNT
--            ,PLAN_CNT
--            ,PLAN_AMT
--            ,RMRK
--            ,CONFIRM
--            ,REVISE
--            ,U_EMP_NO
--            ,U_DATE
--            ,U_IP
--            )
--     VALUES
--            (
--             V_BIZ_CODE
--            ,V_EVENT_NO
--            ,'003'       --V_FUNC_CODE
--            ,V_KEY_SEQ
--            ,'Y'         --V_STATUS_CODE
--            ,V_ST_DATE
--            ,V_ST_TIME
--            ,V_FACILITY_CODE
--            ,V_MENU_CODE
--            ,V_UNIT_AMT
--            ,V_SALE_AMT
--            ,V_PERSON_CNT
--            ,V_PLAN_CNT
--            ,0           --V_PLAN_AMT
--            ,V_RMRK
--            ,'3'         --V_CONFIRM
--            ,'001'       --V_REVISE
--            ,V_EMP_NO
--            ,SYSDATE
--            ,V_IP
--            )
--     ;
--
--     SELECT LEVEL_APPROVE
--       INTO L_LEVEL_APPROVE
--       FROM FAA010MS
--      WHERE BIZ_CODE      = V_BIZ_CODE
--        AND EVENT_NO      = V_EVENT_NO
--     ;
--     IF L_LEVEL_APPROVE = '002' THEN
--       --객실 예약하는 프로시저 콜
--       PR_400(
--         V_BIZ_CODE
--        ,V_EVENT_NO
--        ,'003'
--        ,V_KEY_SEQ
--        ,V_EMP_NO
--        ,V_IP
--        ,V_RET
--       );
--
--       IF V_RET != 'OK' THEN
--         RAISE_APPLICATION_ERROR(-20091, V_RET);
--       END IF;
--     END IF;
--
--     V_RET := 'OK';
--
--     EXCEPTION
--       WHEN OTHERS  THEN
--         V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_110]';
--   END PR_110;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2014.12.16
--     최종 수정일     :
--     작성자          : 정 수 환
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 부대시설 수정
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_111(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--     P_H_SEQ FAA013HS.H_SEQ%TYPE;
--     L_LEVEL_APPROVE  FAA010MS.LEVEL_APPROVE %TYPE;
--   BEGIN
--
--     SELECT NVL(MAX(H_SEQ),0) + 1
--       INTO P_H_SEQ
--       FROM FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     INSERT INTO FAA013HS
--            (
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--            )
--      SELECT
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             P_H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--        FROM FAA013MS
--       WHERE BIZ_CODE  = V_BIZ_CODE
--         AND EVENT_NO  = V_EVENT_NO
--         AND FUNC_CODE = V_FUNC_CODE
--         AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     UPDATE FAA013MS
--        SET STATUS_CODE   = V_STATUS_CODE
--           ,ST_DATE       = V_ST_DATE
--           ,ST_TIME       = V_ST_TIME
--           ,FACILITY_CODE = V_FACILITY_CODE
--           ,MENU_CODE     = V_MENU_CODE
--           ,UNIT_AMT      = V_UNIT_AMT
--           ,SALE_AMT      = V_SALE_AMT
--           ,PERSON_CNT    = V_PERSON_CNT
--           ,PLAN_CNT      = V_PLAN_CNT
--           --,PLAN_AMT      = V_PLAN_AMT
--           ,RMRK          = V_RMRK
--           --,CONFIRM       = V_CONFIRM
--           ,REVISE        = '002'
--           ,U_EMP_NO      = V_EMP_NO
--           ,U_DATE        = SYSDATE
--           ,U_IP          = V_IP
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     SELECT LEVEL_APPROVE
--       INTO L_LEVEL_APPROVE
--       FROM FAA010MS
--      WHERE BIZ_CODE      = V_BIZ_CODE
--        AND EVENT_NO      = V_EVENT_NO
--     ;
--     IF L_LEVEL_APPROVE = '002' THEN
--       --영업장예약 수정하는 프로시저 콜
--       PR_410(
--         V_BIZ_CODE
--        ,V_EVENT_NO
--        ,'003'
--        ,V_KEY_SEQ
--        ,V_EMP_NO
--        ,V_IP
--        ,V_RET
--       );
--       IF V_RET != 'OK' THEN
--         RAISE_APPLICATION_ERROR(-20091, V_RET);
--       END IF;
--     END IF;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_111]';
--   END PR_111;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2014.12.16
--     최종 수정일     :
--     작성자          : 정 수 환
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 부대시설 삭제
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_112(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--     L_LEVEL_APPROVE   FAA010MS.LEVEL_APPROVE %TYPE;
--   BEGIN
--     SELECT LEVEL_APPROVE
--       INTO L_LEVEL_APPROVE
--       FROM FAA010MS
--      WHERE BIZ_CODE      = V_BIZ_CODE
--        AND EVENT_NO      = V_EVENT_NO
--     ;
--
--     IF L_LEVEL_APPROVE = '002' THEN
--       --영업장예약 취소하는 프로시저 콜
--       PR_420(
--         V_BIZ_CODE
--        ,V_EVENT_NO
--        ,'003'
--        ,V_KEY_SEQ
--        ,V_RET
--       );
--       IF V_RET != 'OK' THEN
--         RAISE_APPLICATION_ERROR(-20091, V_RET);
--       END IF;
----       IF V_RET != 'OK' THEN
----         RETURN;
----       END IF;
--     END IF;
--
--     DELETE FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     DELETE FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--       WHEN OTHERS  THEN
--         V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_112]';
--   END PR_112;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2014.12.16
--     최종 수정일     :
--     작성자          : 정 수 환
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 해수찜 입력
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_120(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                    ,V_KEY_SEQ                OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     --순번
--     SELECT NVL(MAX(KEY_SEQ), 0) + 1
--       INTO V_KEY_SEQ
--       FROM FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = '004'  --V_FUNC_CODE, [공통코드:F0002] 001:식음, 002:부대업장(워터파크), 900:기타
--     ;
--
--     INSERT INTO FAA013MS
--            (
--             BIZ_CODE
--            ,EVENT_NO
--            ,FUNC_CODE
--            ,KEY_SEQ
--            ,STATUS_CODE
--            ,ST_DATE
--            ,ST_TIME
--            ,FACILITY_CODE
--            ,MENU_CODE
--            ,UNIT_AMT
--            ,SALE_AMT
--            ,PERSON_CNT
--            ,PLAN_CNT
--            ,PLAN_AMT
--            ,RMRK
--            ,CONFIRM
--            ,REVISE
--            ,U_EMP_NO
--            ,U_DATE
--            ,U_IP
--            )
--     VALUES
--            (
--             V_BIZ_CODE
--            ,V_EVENT_NO
--            ,'004'       --V_FUNC_CODE
--            ,V_KEY_SEQ
--            ,'Y'         --V_STATUS_CODE
--            ,V_ST_DATE
--            ,V_ST_TIME
--            ,V_FACILITY_CODE
--            ,V_MENU_CODE
--            ,V_UNIT_AMT
--            ,V_SALE_AMT
--            ,V_PERSON_CNT
--            ,V_PLAN_CNT
--            ,0           --V_PLAN_AMT
--            ,V_RMRK
--            ,'3'         --V_CONFIRM
--            ,'001'       --V_REVISE
--            ,V_EMP_NO
--            ,SYSDATE
--            ,V_IP
--            )
--     ;
--
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_120]';
--   END PR_120;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2014.12.16
--     최종 수정일     :
--     작성자          : 정 수 환
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 해수찜 수정
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_121(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_STATUS_CODE             IN VARCHAR2
--                    ,V_ST_DATE                 IN VARCHAR2
--                    ,V_ST_TIME                 IN VARCHAR2
--                    ,V_FACILITY_CODE           IN VARCHAR2
--                    ,V_MENU_CODE               IN VARCHAR2
--                    ,V_UNIT_AMT                IN VARCHAR2
--                    ,V_SALE_AMT                IN VARCHAR2
--                    ,V_PERSON_CNT              IN VARCHAR2
--                    ,V_PLAN_CNT                IN VARCHAR2
--                    ,V_PLAN_AMT                IN VARCHAR2
--                    ,V_RMRK                    IN VARCHAR2
--                    ,V_CONFIRM                 IN VARCHAR2
--                    ,V_REVISE                  IN VARCHAR2
--                    ,V_EMP_NO                  IN VARCHAR2
--                    ,V_IP                      IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   P_H_SEQ FAA013HS.H_SEQ%TYPE;
--   BEGIN
--
--     SELECT NVL(MAX(H_SEQ),0) + 1
--       INTO P_H_SEQ
--       FROM FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     INSERT INTO FAA013HS
--            (
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--            )
--      SELECT
--             BIZ_CODE,
--             EVENT_NO,
--             FUNC_CODE,
--             KEY_SEQ,
--             P_H_SEQ,
--             STATUS_CODE,
--             ST_DATE,
--             ST_TIME,
--             FACILITY_CODE,
--             MENU_CODE,
--             UNIT_AMT,
--             SALE_AMT,
--             PERSON_CNT,
--             PLAN_CNT,
--             PLAN_AMT,
--             RMRK,
--             CONFIRM,
--             REVISE,
--             U_EMP_NO,
--             U_DATE,
--             U_IP
--        FROM FAA013MS
--       WHERE BIZ_CODE  = V_BIZ_CODE
--         AND EVENT_NO  = V_EVENT_NO
--         AND FUNC_CODE = V_FUNC_CODE
--         AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     UPDATE FAA013MS
--        SET STATUS_CODE   = V_STATUS_CODE
--           ,ST_DATE       = V_ST_DATE
--           ,ST_TIME       = V_ST_TIME
--           ,FACILITY_CODE = V_FACILITY_CODE
--           ,MENU_CODE     = V_MENU_CODE
--           ,UNIT_AMT      = V_UNIT_AMT
--           ,SALE_AMT      = V_SALE_AMT
--           ,PERSON_CNT    = V_PERSON_CNT
--           ,PLAN_CNT      = V_PLAN_CNT
--           --,PLAN_AMT      = V_PLAN_AMT
--           ,RMRK          = V_RMRK
--           --,CONFIRM       = V_CONFIRM
--           ,REVISE        = '002'
--           ,U_EMP_NO      = V_EMP_NO
--           ,U_DATE        = SYSDATE
--           ,U_IP          = V_IP
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_121]';
--   END PR_121;

--/*============================================================================
--     시스템명        :
--     작 성일         : 2014.12.16
--     최종 수정일     :
--     작성자          : 정 수 환
--    ----------------------------------------------------------------------------
--     프로그램 내용   : 해수찜 삭제
--     사용 테이블     :
--
--    ----------------------------------------------------------------------------
--     프로그램 설명   :
--    ============================================================================*/
--  PROCEDURE PR_122(
--                     V_BIZ_CODE                IN VARCHAR2
--                    ,V_EVENT_NO                IN VARCHAR2
--                    ,V_FUNC_CODE               IN VARCHAR2
--                    ,V_KEY_SEQ                 IN VARCHAR2
--                    ,V_RET                    OUT VARCHAR2
--                  )
--   AS
--   BEGIN
--
--     DELETE FAA013HS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     DELETE FAA013MS
--      WHERE BIZ_CODE  = V_BIZ_CODE
--        AND EVENT_NO  = V_EVENT_NO
--        AND FUNC_CODE = V_FUNC_CODE
--        AND KEY_SEQ   = V_KEY_SEQ
--     ;
--
--     V_RET := 'OK';
--
--     RETURN;
--
--     EXCEPTION
--     WHEN OTHERS  THEN
--          V_RET := FN_GETERROR(SQLCODE)||CHR(13)||'[PKG_FAAAI01.PR_122]';
--   END PR_122;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실예약(한 행사의 전체) 입력
                       결재시 사용
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_210(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_GUEST_TYPE              IN VARCHAR2 --2018-07-03추가
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_ACCEPT_NO                CAA010MS.ACCEPT_NO     %TYPE;
    L_MEMBER_NO                CAA010MS.MEMBER_NO     %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME    %TYPE;
    L_ACCEPT_NAME              CAA010MS.ACCEPT_NAME   %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO  %TYPE;
    L_ACCEPT_TEL_NO            CAA010MS.ACCEPT_TEL_NO %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL    %TYPE;
    L_ACCEPT_MOBILE_TEL        CAA010MS.MOBILE_TEL    %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
          ,MEMBER_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
          ,L_ACCEPT_NO
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --신청자의 정보를 읽어온다.
    SELECT T3.MEMBER_NAME_KOR
          ,T3.HOME_TEL
          ,T3.MOBILE_TEL
      INTO L_ACCEPT_NAME
          ,L_ACCEPT_TEL_NO
          ,L_ACCEPT_MOBILE_TEL
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = L_ACCEPT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --객실예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA011MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
             )
    LOOP
      PKG_CBAAI03.PR_10(
        V_BIZ_CODE
       ,'R'                                                                   --V_STATUS_CODE
       ,L_ACCEPT_NO                                                           --V_ACCEPT_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       --,C_GROUP_GUEST_TYPE                                                    --V_GUEST_TYPE
       ,V_GUEST_TYPE                    --2018-07-03추가
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,'99'                                                                  --V_FACILITY_SEQ
       ,R.ROOM_TYPE                                                           --V_ROOM_TYPE
       ,'XX'                                                                  --V_ROOM_VIEW
       ,'01'                                                                  --V_EXCLUSIVE_CODE
       ,R.CHECKIN_DATE                                                        --V_CHECKIN_DATE
       ,NULL                                                                  --V_CHECKIN_TIME
       ,TO_CHAR(TO_DATE(R.CHECKIN_DATE, 'YYYYMMDD') + R.NIGHTS, 'YYYYMMDD')   --V_CHECKOUT_DATE
       ,R.NIGHTS                                                              --V_NIGHTS
       ,R.ROOM_CNT                                                            --V_ROOM_CNT
       ,R.ADULT_CNT                                                           --V_PERSON_CNT
       ,R.ADULT_CNT                                                           --V_ADULT_CNT
       ,R.CHILD_CNT                                                           --V_CHILD_CNT
       ,R.GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_ACCEPT_NAME                                                         --V_ACCEPT_NAME
       ,NVL(L_ACCEPT_MOBILE_TEL, L_ACCEPT_TEL_NO)                             --V_ACCEPT_TEL_NO
       ,'N'                                                                   --V_VIP_YN
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,'Y'                                                                   --V_TAX_YN
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,NULL                                                                  --V_RSV_LIMIT
       ,'74'                                                                  --V_MARKET_SEGMENT
       ,NULL                                                                  --V_SALE_EMP_NO
       ,NULL                                                                  --V_RATE_TYPE
       ,NULL                                                                  --V_RATE_CHAGE_YN
       ,NULL                                                                  --V_AUTO_CANCEL_YN
       ,NULL                                                                  --V_DC_YN
       ,NULL                                                                  --V_CHECKIN_YN
       ,NULL                                                                  --V_CHECKIN_ROOM_CNT
       ,NULL                                                                  --V_PAYMENT_TYPE
       ,R.RMRK                                                                --V_RMRK
       ,R.KEY_SEQ                                                             --V_KEY_SEQ
       ,V_EVENT_NO                                                            --V_EVENT_NO
       ,R.KEY_SEQ                                                             --V_DC_ADD_NO
       ,R.UNIT_AMT                                                            --V_UNIT_AMT
       ,R.SALE_AMT_DAY                                                        --V_SALE_AMT_DAY
       ,R.SALE_AMT_WEEKEND                                                    --V_SALE_AMT_WEEKEND
       ,R.SALE_AMT                                                            --V_SALE_AMT
       ,'N'                                                                   --V_BLOCK_YN
       ,R.TPR_HARD_CNT                                                        --V_TPR_HARD_CNT
       ,R.TPR_RGLR_CNT                                                        --V_TPR_RGLR_CNT
       ,R.TPR_SOFT_CNT                                                        --V_TPR_SOFT_CNT
       ,R.CARD_CO_CODE                                                        --V_CARD_CO_CODE
       ,R.CARD_NO                                                             --V_CARD_NO
       ,R.VALID_THRU                                                          --V_VALID_THRU
       ,V_EMP_NO                                                              --V_EMP_NO
       ,V_IP                                                                  --V_IP
       ,V_RET                                                                 --V_RET
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      END IF;

      UPDATE FAA011MS T1
         SET T1.CONFIRM   = '1'
       WHERE T1.BIZ_CODE  = R.BIZ_CODE
         AND T1.EVENT_NO  = R.EVENT_NO
         AND T1.KEY_SEQ   = R.KEY_SEQ
      ;

    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_210;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 영업장예약(한 행사의 전체) 입력
                       결재시 사용
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_211(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_GUEST_TYPE              IN VARCHAR2 --2018-07-03추가
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_MEMBER_NO                CAA010MS.MEMBER_NO       %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME      %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO    %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL      %TYPE;
    L_DATE_FROM                JBA011MS.DATE_FROM       %TYPE;
    L_FACILITY_RSV_NO          CIA012MS.FACILITY_RSV_NO %TYPE;
    L_RSV_KEY_SEQ              CIA012MS.RSV_KEY_SEQ     %TYPE;
    L_KEY_SEQ                  CIA012MS.KEY_SEQ         %TYPE;
    L_TABLE_RSV_YN             JBA011MS.TABLE_RSV_YN    %TYPE;
    L_TIME_SEQ                 CIA012MS.TIME_SEQ        %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --영업장예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA013MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
             )
    LOOP
      --메뉴정보의 키값인 DATE_FROM 값을 읽어온다.
      SELECT MAX(DATE_FROM)
        INTO L_DATE_FROM
        FROM JBA011MS
       WHERE BIZ_CODE       = R.BIZ_CODE
         AND FACILITY_CODE  = R.FACILITY_CODE
         AND MENU_CODE      = R.MENU_CODE
      ;

      --메뉴의 테이블(타임)사용여부를 읽어온다.
      SELECT TABLE_RSV_YN
        INTO L_TABLE_RSV_YN
        FROM JBA011MS
       WHERE BIZ_CODE       = R.BIZ_CODE
         AND FACILITY_CODE  = R.FACILITY_CODE
         AND MENU_CODE      = R.MENU_CODE
         AND DATE_FROM      = L_DATE_FROM
      ;

      --해당시간의 TIME_SEQ 값을 읽어온다.
      L_TIME_SEQ := '0';
      IF L_TABLE_RSV_YN = 'Y' THEN
        BEGIN
          SELECT TIME_SEQ
            INTO L_TIME_SEQ
            FROM JIA040MS
           WHERE BIZ_CODE      = R.BIZ_CODE
             AND FACILITY_CODE = R.FACILITY_CODE
             AND CALN_DATE     = R.ST_DATE
             AND START_TIME    = R.ST_TIME
          ;

        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            V_RET := '생성되지 않은 타임을 선택하였습니다.';
            RAISE_APPLICATION_ERROR(-20091, V_RET);
        END;
      END IF;

      PKG_CIAAI11.PR_11(
        V_BIZ_CODE                                                            --V_BIZ_CODE
       ,NULL                                                                  --V_RSV_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       --,C_GROUP_GUEST_TYPE                                                    --V_GUEST_TYPE
       ,V_GUEST_TYPE              --2018-07-03추가
       ,R.PERSON_CNT                                                          --V_PERSON_CNT
       ,L_GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_GUEST_NAME                                                          --V_ACCEPT_NAME
       ,L_GUEST_TEL_NO                                                        --V_ACCEPT_TEL_NO
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,R.RMRK                                                                --V_RMRK
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,R.MENU_CODE                                                           --V_MENU_CODE
       ,L_DATE_FROM                                                           --V_DATE_FROM
       ,R.PERSON_CNT                                                          --V_SALE_QTY
       ,R.SALE_AMT * R.PERSON_CNT                                             --V_APP_AMT
       ,R.ST_DATE                                                             --V_CALN_DATE
       ,L_TIME_SEQ                                                            --V_TIME_SEQ
       ,R.PERSON_CNT                                                          --V_TABLE_QTY
       ,V_EMP_NO                                                              --V_U_EMP_NO
       ,V_IP                                                                  --V_U_IP
       ,V_RET                                                                 --V_RET
       ,L_FACILITY_RSV_NO                                                     --V_FACILITY_RSV_NO
       ,L_RSV_KEY_SEQ                                                         --V_RSV_KEY_SEQ
       ,L_KEY_SEQ                                                             --V_KEY_SEQ
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      ELSE
        UPDATE FAA013MS
           SET FACILITY_RSV_NO  = L_FACILITY_RSV_NO
              ,RSV_KEY_SEQ      = L_RSV_KEY_SEQ
              ,FACILITY_KEY_SEQ = L_KEY_SEQ
              ,CONFIRM          = '1'
         WHERE BIZ_CODE         = R.BIZ_CODE
           AND EVENT_NO         = R.EVENT_NO
           AND FUNC_CODE        = R.FUNC_CODE
           AND KEY_SEQ          = R.KEY_SEQ
        ;
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_211;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실예약(한 행사의 전체) 취소
                       결재취소, 계약취소시 사용
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_220(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_ACCEPT_NO                CAA010MS.ACCEPT_NO     %TYPE;
    L_MEMBER_NO                CAA010MS.MEMBER_NO     %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME    %TYPE;
    L_ACCEPT_NAME              CAA010MS.ACCEPT_NAME   %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO  %TYPE;
    L_ACCEPT_TEL_NO            CAA010MS.ACCEPT_TEL_NO %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL    %TYPE;
    L_ACCEPT_MOBILE_TEL        CAA010MS.MOBILE_TEL    %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
          ,MEMBER_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
          ,L_ACCEPT_NO
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --신청자의 정보를 읽어온다.
    SELECT T3.MEMBER_NAME_KOR
          ,T3.HOME_TEL
          ,T3.MOBILE_TEL
      INTO L_ACCEPT_NAME
          ,L_ACCEPT_TEL_NO
          ,L_ACCEPT_MOBILE_TEL
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = L_ACCEPT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --객실예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA011MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
             )
    LOOP
      PKG_CBAAI03.PR_12(
        V_BIZ_CODE                                                            --V_BIZ_CODE
       ,R.RSV_NO                                                              --V_RSV_NO
       ,'R'                                                                   --V_STATUS_CODE
       ,L_ACCEPT_NO                                                           --V_ACCEPT_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       ,R.GUEST_TYPE                                                          --V_GUEST_TYPE
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,'99'                                                                  --V_FACILITY_SEQ
       ,R.ROOM_TYPE                                                           --V_ROOM_TYPE
       ,'XX'                                                                  --V_ROOM_VIEW
       ,'01'                                                                  --V_EXCLUSIVE_CODE
       ,R.CHECKIN_DATE                                                        --V_CHECKIN_DATE
       ,NULL                                                                  --V_CHECKIN_TIME
       ,TO_CHAR(TO_DATE(R.CHECKIN_DATE, 'YYYYMMDD') + R.NIGHTS, 'YYYYMMDD')   --V_CHECKOUT_DATE
       ,R.NIGHTS                                                              --V_NIGHTS
       ,R.ROOM_CNT                                                            --V_ROOM_CNT
       ,R.PERSON_CNT                                                          --V_PERSON_CNT
       ,R.ADULT_CNT                                                           --V_ADULT_CNT
       ,R.CHILD_CNT                                                           --V_CHILD_CNT
       ,R.GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_ACCEPT_NAME                                                         --V_ACCEPT_NAME
       ,NVL(L_ACCEPT_MOBILE_TEL, L_ACCEPT_TEL_NO)                             --V_ACCEPT_TEL_NO
       ,'N'                                                                   --V_VIP_YN
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,'Y'                                                                   --V_TAX_YN
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,NULL                                                                  --V_RSV_LIMIT
       ,'74'                                                                  --V_MARKET_SEGMENT
       ,NULL                                                                  --V_SALE_EMP_NO
       ,NULL                                                                  --V_RATE_TYPE
       ,NULL                                                                  --V_RATE_CHAGE_YN
       ,NULL                                                                  --V_AUTO_CANCEL_YN
       ,NULL                                                                  --V_DC_YN
       ,NULL                                                                  --V_CHECKIN_YN
       ,NULL                                                                  --V_CHECKIN_ROOM_CNT
       ,NULL                                                                  --V_PAYMENT_TYPE
       ,R.RMRK                                                                --V_RMRK
       ,R.KEY_SEQ                                                             --V_KEY_SEQ
       ,'N'                                                                   --V_BLOCK_YN
       ,V_EVENT_NO                                                            --V_EVENT_NO
       ,R.TPR_HARD_CNT                                                        --V_TPR_HARD_CNT
       ,R.TPR_RGLR_CNT                                                        --V_TPR_RGLR_CNT
       ,R.TPR_SOFT_CNT                                                        --V_TPR_SOFT_CNT
       ,R.CARD_CO_CODE                                                        --V_CARD_CO_CODE
       ,R.CARD_NO                                                             --V_CARD_NO
       ,R.VALID_THRU                                                          --V_VALID_THRU
       ,V_EMP_NO                                                              --V_EMP_NO
       ,V_IP                                                                  --V_IP
       ,V_RET                                                                 --V_RET
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_220;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 영업장예약(한 행사의 전체) 취소
                       결재취소, 계약취소시 사용
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_221(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
  BEGIN

    --영업장예약을 취소한다.
    FOR R IN (
               SELECT *
                 FROM FAA013MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
             )
    LOOP
      UPDATE FAA013MS
         SET FACILITY_RSV_NO  = NULL
            ,RSV_KEY_SEQ      = NULL
            ,FACILITY_KEY_SEQ = NULL
       WHERE BIZ_CODE         = R.BIZ_CODE
         AND EVENT_NO         = R.EVENT_NO
         AND FUNC_CODE        = R.FUNC_CODE
         AND KEY_SEQ          = R.KEY_SEQ
      ;

      PKG_CIAAI10.PR_31(
        R.FACILITY_RSV_NO                                                     --V_FACILITY_RSV_NO
       ,R.RSV_KEY_SEQ                                                         --V_KEY_SEQ
       ,'N'                                                                   --V_SEND_SMS
       ,V_RET                                                                 --V_RET
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_221;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실예약 입력
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_300(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_KEY_SEQ                 IN VARCHAR2
                   ,V_GUEST_TYPE              IN VARCHAR2 --2018-07-03추가
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_ACCEPT_NO                CAA010MS.ACCEPT_NO     %TYPE;
    L_MEMBER_NO                CAA010MS.MEMBER_NO     %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME    %TYPE;
    L_ACCEPT_NAME              CAA010MS.ACCEPT_NAME   %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO  %TYPE;
    L_ACCEPT_TEL_NO            CAA010MS.ACCEPT_TEL_NO %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL    %TYPE;
    L_ACCEPT_MOBILE_TEL        CAA010MS.MOBILE_TEL    %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_SEQ
          ,T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_ACCEPT_NO
          ,L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
          ,MEMBER_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
          ,L_ACCEPT_NO
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --신청자의 정보를 읽어온다.
    SELECT T3.MEMBER_NAME_KOR
          ,T3.HOME_TEL
          ,T3.MOBILE_TEL
      INTO L_ACCEPT_NAME
          ,L_ACCEPT_TEL_NO
          ,L_ACCEPT_MOBILE_TEL
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = L_ACCEPT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --객실예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA011MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
                  AND KEY_SEQ    = V_KEY_SEQ
             )
    LOOP
      PKG_CBAAI03.PR_10(
        V_BIZ_CODE
       ,'R'                                                                   --V_STATUS_CODE
       ,L_ACCEPT_NO                                                           --V_ACCEPT_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       --,C_GROUP_GUEST_TYPE                                                    --V_GUEST_TYPE
       ,V_GUEST_TYPE              --2018-07-03추가
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,'99'                                                                  --V_FACILITY_SEQ
       ,R.ROOM_TYPE                                                           --V_ROOM_TYPE
       ,'XX'                                                                  --V_ROOM_VIEW
       ,'01'                                                                  --V_EXCLUSIVE_CODE
       ,R.CHECKIN_DATE                                                        --V_CHECKIN_DATE
       ,NULL                                                                  --V_CHECKIN_TIME
       ,TO_CHAR(TO_DATE(R.CHECKIN_DATE, 'YYYYMMDD') + R.NIGHTS, 'YYYYMMDD')   --V_CHECKOUT_DATE
       ,R.NIGHTS                                                              --V_NIGHTS
       ,R.ROOM_CNT                                                            --V_ROOM_CNT
       ,R.ADULT_CNT                                                           --V_PERSON_CNT
       ,R.ADULT_CNT                                                           --V_ADULT_CNT
       ,R.CHILD_CNT                                                           --V_CHILD_CNT
       ,R.GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_ACCEPT_NAME                                                         --V_ACCEPT_NAME
       ,NVL(L_ACCEPT_MOBILE_TEL, L_ACCEPT_TEL_NO)                             --V_ACCEPT_TEL_NO
       ,'N'                                                                   --V_VIP_YN
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,'Y'                                                                   --V_TAX_YN
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,NULL                                                                  --V_RSV_LIMIT
       ,'74'                                                                  --V_MARKET_SEGMENT
       ,NULL                                                                  --V_SALE_EMP_NO
       ,NULL                                                                  --V_RATE_TYPE
       ,NULL                                                                  --V_RATE_CHAGE_YN
       ,NULL                                                                  --V_AUTO_CANCEL_YN
       ,NULL                                                                  --V_DC_YN
       ,NULL                                                                  --V_CHECKIN_YN
       ,NULL                                                                  --V_CHECKIN_ROOM_CNT
       ,NULL                                                                  --V_PAYMENT_TYPE
       ,R.RMRK                                                                --V_RMRK
       ,R.KEY_SEQ                                                             --V_KEY_SEQ
       ,V_EVENT_NO                                                            --V_EVENT_NO
       ,R.KEY_SEQ                                                             --V_DC_ADD_NO
       ,R.UNIT_AMT                                                            --V_UNIT_AMT
       ,R.SALE_AMT_DAY                                                        --V_SALE_AMT_DAY
       ,R.SALE_AMT_WEEKEND                                                    --V_SALE_AMT_WEEKEND
       ,R.SALE_AMT                                                            --V_SALE_AMT
       ,'N'                                                                   --V_BLOCK_YN
       ,R.TPR_HARD_CNT                                                        --V_TPR_HARD_CNT
       ,R.TPR_RGLR_CNT                                                        --V_TPR_RGLR_CNT
       ,R.TPR_SOFT_CNT                                                        --V_TPR_SOFT_CNT
       ,R.CARD_CO_CODE                                                        --V_CARD_CO_CODE
       ,R.CARD_NO                                                             --V_CARD_NO
       ,R.VALID_THRU                                                          --V_VALID_THRU
       ,V_EMP_NO                                                              --V_EMP_NO
       ,V_IP                                                                  --V_IP
       ,V_RET                                                                 --V_RET
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      END IF;

      UPDATE FAA011MS T1
         SET T1.CONFIRM   = '1'
       WHERE T1.BIZ_CODE  = R.BIZ_CODE
         AND T1.EVENT_NO  = R.EVENT_NO
         AND T1.KEY_SEQ   = R.KEY_SEQ
      ;

    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_300;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실예약 수정
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_310(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_KEY_SEQ                 IN VARCHAR2
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_ACCEPT_NO                CAA010MS.ACCEPT_NO     %TYPE;
    L_MEMBER_NO                CAA010MS.MEMBER_NO     %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME    %TYPE;
    L_ACCEPT_NAME              CAA010MS.ACCEPT_NAME   %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO  %TYPE;
    L_ACCEPT_TEL_NO            CAA010MS.ACCEPT_TEL_NO %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL    %TYPE;
    L_ACCEPT_MOBILE_TEL        CAA010MS.MOBILE_TEL    %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_SEQ
          ,T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_ACCEPT_NO
          ,L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
          ,MEMBER_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
          ,L_ACCEPT_NO
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --신청자의 정보를 읽어온다.
    SELECT T3.MEMBER_NAME_KOR
          ,T3.HOME_TEL
          ,T3.MOBILE_TEL
      INTO L_ACCEPT_NAME
          ,L_ACCEPT_TEL_NO
          ,L_ACCEPT_MOBILE_TEL
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = L_ACCEPT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --객실예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA011MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
                  AND KEY_SEQ    = V_KEY_SEQ
             )
    LOOP
      PKG_CBAAI03.PR_11(
        V_BIZ_CODE                                                            --V_BIZ_CODE
       ,R.RSV_NO                                                              --V_RSV_NO
       ,'R'                                                                   --V_STATUS_CODE
       ,L_ACCEPT_NO                                                           --V_ACCEPT_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       ,R.GUEST_TYPE                                                          --V_GUEST_TYPE
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,'99'                                                                  --V_FACILITY_SEQ
       ,R.ROOM_TYPE                                                           --V_ROOM_TYPE
       ,'XX'                                                                  --V_ROOM_VIEW
       ,'01'                                                                  --V_EXCLUSIVE_CODE
       ,R.CHECKIN_DATE                                                        --V_CHECKIN_DATE
       ,'1400'                                                                --V_CHECKIN_TIME
       ,TO_CHAR(TO_DATE(R.CHECKIN_DATE, 'YYYYMMDD') + R.NIGHTS, 'YYYYMMDD')   --V_CHECKOUT_DATE
       ,R.NIGHTS                                                              --V_NIGHTS
       ,R.ROOM_CNT                                                            --V_ROOM_CNT
       ,R.PERSON_CNT                                                          --V_PERSON_CNT
       ,R.ADULT_CNT                                                           --V_ADULT_CNT
       ,R.CHILD_CNT                                                           --V_CHILD_CNT
       ,R.GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_ACCEPT_NAME                                                         --V_ACCEPT_NAME
       ,NVL(L_ACCEPT_MOBILE_TEL, L_ACCEPT_TEL_NO)                             --V_ACCEPT_TEL_NO
       ,'N'                                                                   --V_VIP_YN
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,'Y'                                                                   --V_TAX_YN
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,NULL                                                                  --V_RSV_LIMIT
       ,'74'                                                                  --V_MARKET_SEGMENT
       ,NULL                                                                  --V_SALE_EMP_NO
       ,NULL                                                                  --V_RATE_TYPE
       ,NULL                                                                  --V_RATE_CHAGE_YN
       ,NULL                                                                  --V_AUTO_CANCEL_YN
       ,NULL                                                                  --V_DC_YN
       ,NULL                                                                  --V_CHECKIN_YN
       ,NULL                                                                  --V_CHECKIN_ROOM_CNT
       ,NULL                                                                  --V_PAYMENT_TYPE
       ,R.RMRK                                                                --V_RMRK
       ,R.KEY_SEQ                                                             --V_DC_ADD_NO
       ,R.UNIT_AMT                                                            --V_UNIT_AMT
       ,R.SALE_AMT_DAY                                                        --V_SALE_AMT_DAY
       ,R.SALE_AMT_WEEKEND                                                    --V_SALE_AMT_WEEKEND
       ,R.SALE_AMT                                                            --V_SALE_AMT
       ,'N'                                                                   --V_BLOCK_YN
       ,R.TPR_HARD_CNT                                                        --V_TPR_HARD_CNT
       ,R.TPR_RGLR_CNT                                                        --V_TPR_RGLR_CNT
       ,R.TPR_SOFT_CNT                                                        --V_TPR_SOFT_CNT
       ,R.CARD_CO_CODE                                                        --V_CARD_CO_CODE
       ,R.CARD_NO                                                             --V_CARD_NO
       ,R.VALID_THRU                                                          --V_VALID_THRU
       ,V_EMP_NO                                                              --V_EMP_NO
       ,R.KEY_SEQ                                                             --V_KEY_SEQ
       ,V_IP                                                                  --V_IP
       ,V_RET                                                                 --V_RET
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_310;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 객실예약 취소
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_320(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_KEY_SEQ                 IN VARCHAR2
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_ACCEPT_NO                CAA010MS.ACCEPT_NO     %TYPE;
    L_MEMBER_NO                CAA010MS.MEMBER_NO     %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME    %TYPE;
    L_ACCEPT_NAME              CAA010MS.ACCEPT_NAME   %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO  %TYPE;
    L_ACCEPT_TEL_NO            CAA010MS.ACCEPT_TEL_NO %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL    %TYPE;
    L_ACCEPT_MOBILE_TEL        CAA010MS.MOBILE_TEL    %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
          ,MEMBER_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
          ,L_ACCEPT_NO
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --신청자의 정보를 읽어온다.
    SELECT T3.MEMBER_NAME_KOR
          ,T3.HOME_TEL
          ,T3.MOBILE_TEL
      INTO L_ACCEPT_NAME
          ,L_ACCEPT_TEL_NO
          ,L_ACCEPT_MOBILE_TEL
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = L_ACCEPT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --객실예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA011MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
                  AND KEY_SEQ    = V_KEY_SEQ
             )
    LOOP
      PKG_CBAAI03.PR_12(
        V_BIZ_CODE                                                            --V_BIZ_CODE
       ,R.RSV_NO                                                              --V_RSV_NO
       ,'R'                                                                   --V_STATUS_CODE
       ,L_ACCEPT_NO                                                           --V_ACCEPT_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       ,R.GUEST_TYPE                                                          --V_GUEST_TYPE
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,'99'                                                                  --V_FACILITY_SEQ
       ,R.ROOM_TYPE                                                           --V_ROOM_TYPE
       ,'XX'                                                                  --V_ROOM_VIEW
       ,'01'                                                                  --V_EXCLUSIVE_CODE
       ,R.CHECKIN_DATE                                                        --V_CHECKIN_DATE
       ,NULL                                                                  --V_CHECKIN_TIME
       ,TO_CHAR(TO_DATE(R.CHECKIN_DATE, 'YYYYMMDD') + R.NIGHTS, 'YYYYMMDD')   --V_CHECKOUT_DATE
       ,R.NIGHTS                                                              --V_NIGHTS
       ,R.ROOM_CNT                                                            --V_ROOM_CNT
       ,R.PERSON_CNT                                                          --V_PERSON_CNT
       ,R.ADULT_CNT                                                           --V_ADULT_CNT
       ,R.CHILD_CNT                                                           --V_CHILD_CNT
       ,R.GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_ACCEPT_NAME                                                         --V_ACCEPT_NAME
       ,NVL(L_ACCEPT_MOBILE_TEL, L_ACCEPT_TEL_NO)                             --V_ACCEPT_TEL_NO
       ,'N'                                                                   --V_VIP_YN
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,'Y'                                                                   --V_TAX_YN
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,NULL                                                                  --V_RSV_LIMIT
       ,'74'                                                                  --V_MARKET_SEGMENT
       ,NULL                                                                  --V_SALE_EMP_NO
       ,NULL                                                                  --V_RATE_TYPE
       ,NULL                                                                  --V_RATE_CHAGE_YN
       ,NULL                                                                  --V_AUTO_CANCEL_YN
       ,NULL                                                                  --V_DC_YN
       ,NULL                                                                  --V_CHECKIN_YN
       ,NULL                                                                  --V_CHECKIN_ROOM_CNT
       ,NULL                                                                  --V_PAYMENT_TYPE
       ,R.RMRK                                                                --V_RMRK
       ,R.KEY_SEQ                                                             --V_KEY_SEQ
       ,'N'                                                                   --V_BLOCK_YN
       ,V_EVENT_NO                                                            --V_EVENT_NO
       ,R.TPR_HARD_CNT                                                        --V_TPR_HARD_CNT
       ,R.TPR_RGLR_CNT                                                        --V_TPR_RGLR_CNT
       ,R.TPR_SOFT_CNT                                                        --V_TPR_SOFT_CNT
       ,R.CARD_CO_CODE                                                        --V_CARD_CO_CODE
       ,R.CARD_NO                                                             --V_CARD_NO
       ,R.VALID_THRU                                                          --V_VALID_THRU
       ,V_EMP_NO                                                              --V_EMP_NO
       ,V_IP                                                                  --V_IP
       ,V_RET                                                                 --V_RET
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_320;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 영업장예약 입력
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_400(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_FUNC_CODE               IN VARCHAR2
                   ,V_KEY_SEQ                 IN VARCHAR2
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_MEMBER_NO                CAA010MS.MEMBER_NO       %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME      %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO    %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL      %TYPE;
    L_DATE_FROM                JBA011MS.DATE_FROM       %TYPE;
    L_FACILITY_RSV_NO          CIA012MS.FACILITY_RSV_NO %TYPE;
    L_RSV_KEY_SEQ              CIA012MS.RSV_KEY_SEQ     %TYPE;
    L_KEY_SEQ                  CIA012MS.KEY_SEQ         %TYPE;
    L_TABLE_RSV_YN             JBA011MS.TABLE_RSV_YN    %TYPE;
    L_TIME_SEQ                 CIA012MS.TIME_SEQ        %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --영업장예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA013MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
                  AND FUNC_CODE  = V_FUNC_CODE
                  AND KEY_SEQ    = V_KEY_SEQ
             )
    LOOP
      --메뉴정보의 키값인 DATE_FROM 값을 읽어온다.
      SELECT MAX(DATE_FROM)
        INTO L_DATE_FROM
        FROM JBA011MS
       WHERE BIZ_CODE       = R.BIZ_CODE
         AND FACILITY_CODE  = R.FACILITY_CODE
         AND MENU_CODE      = R.MENU_CODE
      ;

      --메뉴의 테이블(타임)사용여부를 읽어온다.
      SELECT TABLE_RSV_YN
        INTO L_TABLE_RSV_YN
        FROM JBA011MS
       WHERE BIZ_CODE       = R.BIZ_CODE
         AND FACILITY_CODE  = R.FACILITY_CODE
         AND MENU_CODE      = R.MENU_CODE
         AND DATE_FROM      = L_DATE_FROM
      ;

      --해당시간의 TIME_SEQ 값을 읽어온다.
      L_TIME_SEQ := '0';
      IF L_TABLE_RSV_YN = 'Y' THEN
        BEGIN
          SELECT TIME_SEQ
            INTO L_TIME_SEQ
            FROM JIA040MS
           WHERE BIZ_CODE      = R.BIZ_CODE
             AND FACILITY_CODE = R.FACILITY_CODE
             AND CALN_DATE     = R.ST_DATE
             AND START_TIME    = R.ST_TIME
          ;

        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            V_RET := '생성되지 않은 타임을 선택하였습니다.';
            RAISE_APPLICATION_ERROR(-20091, V_RET);
        END;
      END IF;

      PKG_CIAAI11.PR_11(
        V_BIZ_CODE                                                            --V_BIZ_CODE
       ,NULL                                                                  --V_RSV_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       ,C_GROUP_GUEST_TYPE                                                    --V_GUEST_TYPE
       ,R.PERSON_CNT                                                          --V_PERSON_CNT
       ,L_GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_GUEST_NAME                                                          --V_ACCEPT_NAME
       ,L_GUEST_TEL_NO                                                        --V_ACCEPT_TEL_NO
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,R.RMRK                                                                --V_RMRK
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,R.MENU_CODE                                                           --V_MENU_CODE
       ,L_DATE_FROM                                                           --V_DATE_FROM
       ,R.PERSON_CNT                                                          --V_SALE_QTY
       ,R.SALE_AMT * R.PERSON_CNT                                             --V_APP_AMT
       ,R.ST_DATE                                                             --V_CALN_DATE
       ,L_TIME_SEQ                                                            --V_TIME_SEQ
       ,R.PERSON_CNT                                                          --V_TABLE_QTY
       ,V_EMP_NO                                                              --V_U_EMP_NO
       ,V_IP                                                                  --V_U_IP
       ,V_RET                                                                 --V_RET
       ,L_FACILITY_RSV_NO                                                     --V_FACILITY_RSV_NO
       ,L_RSV_KEY_SEQ                                                         --V_RSV_KEY_SEQ
       ,L_KEY_SEQ                                                             --V_KEY_SEQ
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      ELSE
        UPDATE FAA013MS
           SET FACILITY_RSV_NO  = L_FACILITY_RSV_NO
              ,RSV_KEY_SEQ      = L_RSV_KEY_SEQ
              ,FACILITY_KEY_SEQ = L_KEY_SEQ
              ,CONFIRM          = '1'
         WHERE BIZ_CODE         = R.BIZ_CODE
           AND EVENT_NO         = R.EVENT_NO
           AND FUNC_CODE        = R.FUNC_CODE
           AND KEY_SEQ          = R.KEY_SEQ
        ;
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_400;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 영업장예약 수정
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_410(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_FUNC_CODE               IN VARCHAR2
                   ,V_KEY_SEQ                 IN VARCHAR2
                   ,V_EMP_NO                  IN VARCHAR2
                   ,V_IP                      IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
    L_MEMBER_NO                CAA010MS.MEMBER_NO       %TYPE;
    L_GUEST_NAME               CAA010MS.GUEST_NAME      %TYPE;
    L_GUEST_TEL_NO             CAA010MS.GUEST_TEL_NO    %TYPE;
    L_MOBILE_TEL               CAA010MS.MOBILE_TEL      %TYPE;
    L_DATE_FROM                JBA011MS.DATE_FROM       %TYPE;
    L_FACILITY_RSV_NO          CIA012MS.FACILITY_RSV_NO %TYPE;
    L_RSV_KEY_SEQ              CIA012MS.RSV_KEY_SEQ     %TYPE;
    L_KEY_SEQ                  CIA012MS.KEY_SEQ         %TYPE;
    L_TABLE_RSV_YN             JBA011MS.TABLE_RSV_YN    %TYPE;
    L_TIME_SEQ                 CIA012MS.TIME_SEQ        %TYPE;
  BEGIN

    --회원 정보를 읽어온다.
    SELECT T1.MEMBER_NO
          ,T3.MEMBER_NAME_KOR
      INTO L_MEMBER_NO
          ,L_GUEST_NAME
      FROM BBA011MS T1
     INNER JOIN BBA012MS T2
        ON T2.MEMBER_SEQ  = T1.MEMBER_SEQ
     INNER JOIN BBA020MS T3
        ON T3.CUST_NO     = T2.CUST_NO
     WHERE T1.MEMBER_NO   = V_EVENT_NO
       AND T1.BIZ_CODE    = V_BIZ_CODE
    ;

    --단체마스터 정보를 읽어온다.
    SELECT CUST_TEL_NO
          ,CUST_MOBILE_NO
      INTO L_GUEST_TEL_NO
          ,L_MOBILE_TEL
      FROM FAA010MS
     WHERE BIZ_CODE     = V_BIZ_CODE
       AND EVENT_NO     = V_EVENT_NO
    ;

    --영업장예약을 처리한다.
    FOR R IN (
               SELECT *
                 FROM FAA013MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
                  AND FUNC_CODE  = V_FUNC_CODE
                  AND KEY_SEQ    = V_KEY_SEQ
             )
    LOOP
      --메뉴정보의 키값인 DATE_FROM 값을 읽어온다.
      SELECT MAX(DATE_FROM)
        INTO L_DATE_FROM
        FROM JBA011MS
       WHERE BIZ_CODE       = R.BIZ_CODE
         AND FACILITY_CODE  = R.FACILITY_CODE
         AND MENU_CODE      = R.MENU_CODE
      ;

      --메뉴의 테이블(타임)사용여부를 읽어온다.
      SELECT TABLE_RSV_YN
        INTO L_TABLE_RSV_YN
        FROM JBA011MS
       WHERE BIZ_CODE       = R.BIZ_CODE
         AND FACILITY_CODE  = R.FACILITY_CODE
         AND MENU_CODE      = R.MENU_CODE
         AND DATE_FROM      = L_DATE_FROM
      ;

      --해당시간의 TIME_SEQ 값을 읽어온다.
      L_TIME_SEQ := '0';
      IF L_TABLE_RSV_YN = 'Y' THEN
        BEGIN
          SELECT TIME_SEQ
            INTO L_TIME_SEQ
            FROM JIA040MS
           WHERE BIZ_CODE      = R.BIZ_CODE
             AND FACILITY_CODE = R.FACILITY_CODE
             AND CALN_DATE     = R.ST_DATE
             AND START_TIME    = R.ST_TIME
          ;

        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            V_RET := '생성되지 않은 타임을 선택하였습니다.';
            RAISE_APPLICATION_ERROR(-20091, V_RET);
        END;
      END IF;
--      RAISE_APPLICATION_ERROR(-20092, L_TIME_SEQ);

      PKG_CIAAI10.PR_18(
        V_BIZ_CODE                                                            --V_BIZ_CODE
       ,R.FACILITY_RSV_NO                                                     --V_FACILITY_RSV_NO
       ,R.RSV_KEY_SEQ                                                         --V_RSV_KEY_SEQ
       ,NULL                                                                  --V_RSV_NO
       ,L_MEMBER_NO                                                           --V_MEMBER_NO
       ,'1'                                                                   --V_USER_CODE
       ,C_GROUP_GUEST_TYPE                                                    --V_GUEST_TYPE
       ,R.PERSON_CNT                                                          --V_PERSON_CNT
       ,L_GUEST_NAME                                                          --V_GUEST_NAME
       ,NULL                                                                  --V_GUEST_ID
       ,L_GUEST_TEL_NO                                                        --V_GUEST_TEL_NO
       ,'KR'                                                                  --V_NATIONAL_CODE
       ,NULL                                                                  --V_AREA_CODE
       ,NULL                                                                  --V_SEX_CODE
       ,L_MOBILE_TEL                                                          --V_MOBILE_TEL
       ,L_GUEST_NAME                                                          --V_ACCEPT_NAME
       ,L_GUEST_TEL_NO                                                        --V_ACCEPT_TEL_NO
       ,'01'                                                                  --V_RSV_WAY
       ,'03'                                                                  --V_RSV_PART
       ,R.RMRK                                                                --V_RMRK
       ,R.FACILITY_CODE                                                       --V_FACILITY_CODE
       ,R.MENU_CODE                                                           --V_MENU_CODE
       ,L_DATE_FROM                                                           --V_DATE_FROM
       ,R.PERSON_CNT                                                          --V_SALE_QTY
       ,ROUND((R.UNIT_AMT - R.SALE_AMT) / R.UNIT_AMT * 100, 2)                --V_DC_RATE
       ,R.SALE_AMT * R.PERSON_CNT                                             --V_APP_AMT
       ,R.FACILITY_KEY_SEQ                                                    --V_KEY_SEQ
       ,R.ST_DATE                                                             --V_CALN_DATE
       ,L_TIME_SEQ                                                            --V_TIME_SEQ
       ,R.PERSON_CNT                                                          --V_TABLE_QTY
       ,V_EMP_NO                                                              --V_U_EMP_NO
       ,V_IP                                                                  --V_U_IP
       ,V_RET                                                                 --V_RET
      );

      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
--      ELSE
--        UPDATE FAA013MS
--           SET FACILITY_RSV_NO  = L_FACILITY_RSV_NO
--              ,RSV_KEY_SEQ      = L_RSV_KEY_SEQ
--              ,FACILITY_KEY_SEQ = L_KEY_SEQ
--         WHERE BIZ_CODE         = R.BIZ_CODE
--           AND EVENT_NO         = R.EVENT_NO
--           AND FUNC_CODE        = R.FUNC_CODE
--           AND KEY_SEQ          = R.KEY_SEQ
--        ;
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_410;

/*============================================================================
     시스템명        :
     작 성일         : 2014.12.16
     최종 수정일     :
     작성자          : 정 수 환
    ----------------------------------------------------------------------------
     프로그램 내용   : 영업장예약 취소
     사용 테이블     :

    ----------------------------------------------------------------------------
     프로그램 설명   :
    ============================================================================*/
  PROCEDURE PR_420(
                    V_BIZ_CODE                IN VARCHAR2
                   ,V_EVENT_NO                IN VARCHAR2
                   ,V_FUNC_CODE               IN VARCHAR2
                   ,V_KEY_SEQ                 IN VARCHAR2
                   ,V_RET                    OUT VARCHAR2
                 )
  AS
  BEGIN

    --영업장예약을 취소한다.
    FOR R IN (
               SELECT *
                 FROM FAA013MS
                WHERE BIZ_CODE   = V_BIZ_CODE
                  AND EVENT_NO   = V_EVENT_NO
                  AND FUNC_CODE  = V_FUNC_CODE
                  AND KEY_SEQ    = V_KEY_SEQ
             )
    LOOP
      UPDATE FAA013MS
         SET FACILITY_RSV_NO  = NULL
            ,RSV_KEY_SEQ      = NULL
            ,FACILITY_KEY_SEQ = NULL
       WHERE BIZ_CODE         = R.BIZ_CODE
         AND EVENT_NO         = R.EVENT_NO
         AND FUNC_CODE        = R.FUNC_CODE
         AND KEY_SEQ          = R.KEY_SEQ
      ;

      PKG_CIAAI10.PR_31(
        R.FACILITY_RSV_NO                                                     --V_FACILITY_RSV_NO
       ,R.RSV_KEY_SEQ                                                         --V_KEY_SEQ
       ,'N'                                                                   --V_SEND_SMS
       ,V_RET                                                                 --V_RET
      );
      IF V_RET != 'OK' THEN
        RAISE_APPLICATION_ERROR(-20091, V_RET);
      END IF;
    END LOOP;

    V_RET := 'OK';

  EXCEPTION
    WHEN OTHERS THEN
      V_RET := SQLERRM;

  END PR_420;

END PKG_FAAEI01;


